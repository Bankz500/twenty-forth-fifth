<!DOCTYPE html>
<html lang="en" itemscope itemtype="https://schema.org/Blog">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>Client Testimonials & Reviews | Beal Offshore Ltd - Verified Customer Experiences</title>
    <meta name="description" content="Read verified client testimonials and reviews for Beal Offshore Ltd. Real customer experiences from businesses worldwide praising our offshore banking services, compliance expertise, and professional operations." />
    <meta name="keywords" content="Beal Offshore, Beal Offshore Ltd, offshore banking, testimonials, reviews, client reviews, verified reviews, customer experiences, offshore banking services, international banking, compliance, offshore accounts, banking reviews, Beal Offshore reviews, Beal Offshore testimonials" />
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1" />
    <meta name="author" content="Beal Offshore Ltd" />
    <meta name="geo.region" content="US" />
    <meta name="geo.placename" content="Offshore Banking Services" />
    <link rel="canonical" href="https://beal-offshore.com/testimonials" />
    <link rel="sitemap" type="application/xml" href="/sitemap.xml" />
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" sizes="180x180" href="logo new.png">
    <link rel="icon" href="logo new.png" type="image/png">
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://beal-offshore.com/testimonials" />
    <meta property="og:title" content="Client Testimonials & Reviews | Beal Offshore Ltd" />
    <meta property="og:description" content="Read verified client testimonials and reviews for Beal Offshore Ltd. Real customer experiences from businesses worldwide." />
    <meta property="og:image" content="https://beal-offshore.com/Logo.png" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Client Testimonials & Reviews | Beal Offshore Ltd" />
    <meta name="twitter:description" content="Read verified client testimonials and reviews for Beal Offshore Ltd." />
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Playfair+Display:wght@400;600;700&display=swap" rel="stylesheet">
    
    <style>
      body {
        font-family: 'Inter', sans-serif;
      }
      .blog-title {
        font-family: 'Playfair Display', serif;
      }
      .testimonial-card {
        transition: all 0.3s ease;
      }
      .testimonial-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
      }
      .like-btn, .dislike-btn {
        transition: all 0.2s ease;
      }
      .like-btn:hover {
        color: #10b981;
        transform: scale(1.1);
      }
      .dislike-btn:hover {
        color: #ef4444;
        transform: scale(1.1);
      }
      .like-btn.active {
        color: #10b981;
      }
      .dislike-btn.active {
        color: #ef4444;
      }
      .category-badge {
        display: inline-block;
        padding: 0.25rem 0.75rem;
        border-radius: 9999px;
        font-size: 0.75rem;
        font-weight: 500;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        cursor: pointer;
        transition: all 0.2s ease;
        white-space: nowrap;
        user-select: none;
      }
      .category-badge:hover {
        transform: scale(1.05);
      }
      .category-badge.active {
        box-shadow: 0 10px 15px -3px rgba(102, 126, 234, 0.25), 0 4px 6px -4px rgba(102, 126, 234, 0.25);
        outline: 2px solid rgba(102, 126, 234, 0.35);
        outline-offset: 2px;
      }
      .text-clamp-2 {
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
      }
      .search-input:focus {
        outline: none;
        ring: 2px;
        ring-color: #667eea;
      }
      @keyframes pulse {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.5; }
      }
      .loading {
        animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
      }
    </style>
    
    <!-- JSON-LD Structured Data for SEO and AI Systems -->
    <script type="application/ld+json" id="organization-schema">
      {
        "@context": "https://schema.org",
        "@type": "Organization",
        "@id": "https://beal-offshore.com/#organization",
        "name": "Beal Offshore Ltd",
        "alternateName": "Beal Offshore",
        "url": "https://beal-offshore.com",
        "logo": {
          "@type": "ImageObject",
          "url": "https://beal-offshore.com/Logo.png",
          "width": 200,
          "height": 200
        },
        "description": "Beal Offshore Ltd provides professional offshore banking services with expertise in compliance and international transactions. Trusted by businesses worldwide for secure offshore banking solutions.",
        "foundingDate": "2020",
        "contactPoint": {
          "@type": "ContactPoint",
          "contactType": "Customer Service",
          "availableLanguage": ["English"]
        },
        "sameAs": [
          "https://beal-offshore.com"
        ],
        "areaServed": {
          "@type": "Place",
          "name": "Worldwide"
        },
        "serviceType": "Offshore Banking Services"
      }
    </script>
    
    <script type="application/ld+json" id="testimonials-schema">
      {
        "@context": "https://schema.org",
        "@type": "WebPage",
        "@id": "https://beal-offshore.com/testimonials#webpage",
        "url": "https://beal-offshore.com/testimonials",
        "name": "Client Testimonials & Reviews | Beal Offshore Ltd",
        "description": "Verified client testimonials and reviews for Beal Offshore Ltd. Read authentic customer experiences from businesses worldwide.",
        "inLanguage": "en-US",
        "isPartOf": {
          "@id": "https://beal-offshore.com/#website"
        },
        "about": {
          "@id": "https://beal-offshore.com/#organization"
        },
        "primaryImageOfPage": {
          "@type": "ImageObject",
          "url": "https://beal-offshore.com/Logo.png"
        }
      }
    </script>
    
    <script type="application/ld+json" id="website-schema">
      {
        "@context": "https://schema.org",
        "@type": "WebSite",
        "@id": "https://beal-offshore.com/#website",
        "url": "https://beal-offshore.com",
        "name": "Beal Offshore Ltd",
        "description": "Professional offshore banking services trusted by businesses worldwide",
        "publisher": {
          "@id": "https://beal-offshore.com/#organization"
        },
        "potentialAction": {
          "@type": "SearchAction",
          "target": {
            "@type": "EntryPoint",
            "urlTemplate": "https://beal-offshore.com/testimonials?search={search_term_string}"
          },
          "query-input": "required name=search_term_string"
        }
      }
    </script>
    
    <script type="application/ld+json" id="breadcrumb-schema">
      {
        "@context": "https://schema.org",
        "@type": "BreadcrumbList",
        "itemListElement": [
          {
            "@type": "ListItem",
            "position": 1,
            "name": "Home",
            "item": "https://beal-offshore.com"
          },
          {
            "@type": "ListItem",
            "position": 2,
            "name": "Testimonials",
            "item": "https://beal-offshore.com/testimonials"
          }
        ]
      }
    </script>
    
    <script type="application/ld+json" id="blog-schema">
      {
        "@context": "https://schema.org",
        "@type": "Blog",
        "name": "Beal Offshore Ltd Testimonials",
        "description": "Verified client testimonials and reviews for Beal Offshore Ltd",
        "url": "https://beal-offshore.com/testimonials",
        "publisher": {
          "@type": "Organization",
          "name": "Beal Offshore Ltd",
          "logo": {
            "@type": "ImageObject",
            "url": "https://beal-offshore.com/Logo.png"
          }
        }
      }
    </script>
  </head>
  <body class="min-h-screen bg-gradient-to-br from-gray-50 via-white to-gray-50">
    <!-- Header Navigation -->
    <header class="bg-white border-b border-gray-200 sticky top-0 z-50 shadow-sm">
      <nav class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between items-center h-16">
          <div class="flex items-center">
            <a href="/" class="flex items-center">
              <img src="Logo.png" alt="Beal Offshore Ltd" class="h-10 w-auto">
            </a>
          </div>
          <div class="hidden md:flex items-center space-x-6">
            <a href="/" class="text-gray-600 hover:text-gray-900 transition-colors">Home</a>
            <a href="/testimonials" class="text-purple-600 font-semibold">Testimonials</a>
            <a href="/contact.html" class="text-gray-600 hover:text-gray-900 transition-colors">Contact</a>
          </div>
        </div>
      </nav>
    </header>

    <!-- Breadcrumbs -->
    <nav class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4" aria-label="Breadcrumb">
      <ol class="flex items-center space-x-2 text-sm text-gray-600">
        <li><a href="/" class="hover:text-purple-600 transition-colors">Home</a></li>
        <li><i class="fas fa-chevron-right text-xs mx-2"></i></li>
        <li class="text-gray-900 font-medium">Testimonials</li>
      </ol>
    </nav>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
      <!-- Hero Section with Brand -->
      <header class="mb-12 text-center">
        <div class="flex items-center justify-center mb-6">
          <img src="Logo.png" alt="Beal Offshore Ltd" class="h-20 w-auto">
        </div>
        <h1 class="blog-title text-4xl md:text-5xl lg:text-6xl font-bold text-gray-900 mb-4">
          Client Testimonials & Reviews
        </h1>
        <p class="text-xl text-gray-600 max-w-3xl mx-auto mb-6">
          Verified customer experiences from businesses worldwide. Read authentic reviews from clients who trust Beal Offshore Ltd for their offshore banking needs.
        </p>
        <div class="flex items-center justify-center space-x-6 text-sm text-gray-500 flex-wrap gap-4">
          <span class="flex items-center">
            <i class="fas fa-check-circle text-green-500 mr-2"></i>
            <span>Verified Reviews</span>
          </span>
          <span class="flex items-center">
            <i class="fas fa-globe text-blue-500 mr-2"></i>
            <span>Global Clients</span>
          </span>
          <span class="flex items-center">
            <i class="fas fa-shield-alt text-purple-500 mr-2"></i>
            <span>Trusted & Secure</span>
          </span>
          <span class="flex items-center">
            <i class="fas fa-star text-yellow-500 mr-2"></i>
            <span>5-Star Rated</span>
          </span>
        </div>
      </header>

      <!-- Search and Filter Bar -->
      <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-8">
        <div class="flex flex-col md:flex-row gap-4 items-center">
          <div class="flex-1 w-full relative">
            <i class="fas fa-search absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
            <input 
              type="text" 
              id="searchInput" 
              placeholder="Search testimonials by author, company, country, or review text..."
              class="w-full pl-12 pr-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent search-input"
            >
          </div>
          <div class="flex items-center gap-2 w-full md:w-auto">
            <select id="sortSelect" class="w-full md:w-auto border border-gray-300 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-purple-500">
              <option value="newest">Newest First</option>
              <option value="oldest">Oldest First</option>
              <option value="rating">Highest Rating</option>
              <option value="likes">Most Liked</option>
            </select>
            <button id="clearSearch" class="shrink-0 px-4 py-3 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors hidden" aria-label="Clear search">
              <i class="fas fa-times"></i>
            </button>
          </div>
        </div>
        <div id="searchResults" class="mt-4 text-sm text-gray-600 hidden">
          <span id="searchCount">0</span> testimonials found
        </div>
      </div>

      <!-- Stats Bar -->
      <div id="statsBar" class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-12">
        <div class="bg-gradient-to-br from-purple-600 to-indigo-700 rounded-xl p-6 shadow-lg text-white text-center transform hover:scale-105 transition-transform">
          <div class="text-4xl font-bold mb-2" id="totalReviews">0</div>
          <div class="text-sm opacity-90">Total Reviews</div>
        </div>
        <div class="bg-gradient-to-br from-yellow-400 to-orange-500 rounded-xl p-6 shadow-lg text-white text-center transform hover:scale-105 transition-transform">
          <div class="text-4xl font-bold mb-2" id="avgRating">0.0</div>
          <div class="text-sm opacity-90">Average Rating</div>
        </div>
        <div class="bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl p-6 shadow-lg text-white text-center transform hover:scale-105 transition-transform">
          <div class="text-4xl font-bold mb-2" id="verifiedCount">0</div>
          <div class="text-sm opacity-90">Verified Reviews</div>
        </div>
        <div class="bg-gradient-to-br from-blue-500 to-cyan-600 rounded-xl p-6 shadow-lg text-white text-center transform hover:scale-105 transition-transform">
          <div class="text-4xl font-bold mb-2" id="countriesCount">0</div>
          <div class="text-sm opacity-90">Countries</div>
        </div>
      </div>

      <!-- Main Content Area -->
      <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
        <!-- Testimonials Feed (2/3 width) -->
        <div class="lg:col-span-2">
          <div class="mb-6 flex items-center justify-between flex-wrap gap-4">
            <h2 class="blog-title text-2xl font-bold text-gray-900">Latest Reviews</h2>
            <div class="w-full md:w-auto">
              <div class="text-sm text-gray-600 mb-2 md:hidden">Filter:</div>
              <div class="flex items-center gap-2 overflow-x-auto md:overflow-visible -mx-4 px-4 md:mx-0 md:px-0 pb-2 md:pb-0">
                <button class="category-badge active" data-filter="all">All</button>
                <button class="category-badge" data-filter="verified">Verified</button>
                <button class="category-badge" data-filter="5star">5 Stars</button>
                <button class="category-badge" data-filter="recent">Recent</button>
                <button class="category-badge" data-filter="business">Business</button>
                <button class="category-badge" data-filter="individual">Individuals</button>
              </div>
            </div>
          </div>

          <div id="testimonials-container" class="space-y-6">
            <div class="bg-white rounded-xl border border-gray-200 p-8 text-center">
              <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto mb-4"></div>
              <p class="text-gray-600">Loading testimonials...</p>
            </div>
          </div>
        </div>

        <!-- Sidebar (1/3 width) -->
        <aside class="lg:col-span-1 space-y-6">
          <!-- About Section -->
          <div class="bg-gradient-to-br from-purple-600 to-indigo-700 rounded-xl p-6 text-white">
            <h3 class="blog-title text-2xl font-bold mb-3">About Beal Offshore</h3>
            <p class="text-purple-100 text-sm leading-relaxed mb-4">
              Trusted by businesses worldwide for professional offshore banking services, compliance expertise, and seamless international transactions.
            </p>
            <a href="/" class="inline-block bg-white text-purple-600 px-4 py-2 rounded-lg font-semibold text-sm hover:bg-purple-50 transition-colors">
              Learn More
            </a>
          </div>

          <!-- Trust Badges -->
          <div class="bg-white rounded-xl border border-gray-200 p-6">
            <h3 class="font-bold text-gray-900 mb-4 flex items-center">
              <i class="fas fa-shield-alt text-green-500 mr-2"></i>
              Trust Indicators
            </h3>
            <ul class="space-y-3 text-sm">
              <li class="flex items-center text-gray-700">
                <i class="fas fa-check-circle text-green-500 mr-2"></i>
                Verified Customer Reviews
              </li>
              <li class="flex items-center text-gray-700">
                <i class="fas fa-check-circle text-green-500 mr-2"></i>
                Global Client Base
              </li>
              <li class="flex items-center text-gray-700">
                <i class="fas fa-check-circle text-green-500 mr-2"></i>
                Compliance Certified
              </li>
              <li class="flex items-center text-gray-700">
                <i class="fas fa-check-circle text-green-500 mr-2"></i>
                Secure Banking Platform
              </li>
            </ul>
          </div>

          <!-- Categories -->
          <div class="bg-white rounded-xl border border-gray-200 p-6">
            <h3 class="font-bold text-gray-900 mb-4">Review Categories</h3>
            <div class="flex flex-wrap gap-2">
              <span class="category-badge">Offshore Banking</span>
              <span class="category-badge">Compliance</span>
              <span class="category-badge">International</span>
              <span class="category-badge">Customer Service</span>
              <span class="category-badge">Security</span>
            </div>
          </div>

          <!-- Popular Reviews -->
          <div class="bg-white rounded-xl border border-gray-200 p-6">
            <h3 class="font-bold text-gray-900 mb-4">
              <i class="fas fa-fire text-orange-500 mr-2"></i>
              Most Liked Reviews
            </h3>
            <div id="popularReviews" class="space-y-3">
              <p class="text-sm text-gray-500">Loading...</p>
            </div>
          </div>
        </aside>
      </div>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-900 text-white mt-16">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
          <div>
            <div class="flex items-center mb-4">
              <img src="Logo.png" alt="Beal Offshore Ltd" class="h-8 w-auto">
            </div>
            <p class="text-gray-400 text-sm">
              Professional offshore banking services trusted by businesses worldwide.
            </p>
          </div>
          <div>
            <h4 class="font-semibold mb-4">Quick Links</h4>
            <ul class="space-y-2 text-sm text-gray-400">
              <li><a href="/" class="hover:text-white transition-colors">Home</a></li>
              <li><a href="/testimonials" class="hover:text-white transition-colors">Testimonials</a></li>
              <li><a href="/contact.html" class="hover:text-white transition-colors">Contact</a></li>
            </ul>
          </div>
          <div>
            <h4 class="font-semibold mb-4">Legal</h4>
            <ul class="space-y-2 text-sm text-gray-400">
              <li><a href="#" class="hover:text-white transition-colors">Privacy Policy</a></li>
              <li><a href="#" class="hover:text-white transition-colors">Terms of Service</a></li>
            </ul>
          </div>
        </div>
        <div class="border-t border-gray-800 mt-8 pt-8 text-center text-sm text-gray-400">
          <p>&copy; 2024 Beal Offshore Ltd. All rights reserved.</p>
        </div>
      </div>
    </footer>

    <script type="module">
      import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js';
      import { getFirestore, collection, getDocs, query, where } from 'https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js';

      const firebaseConfig = {
        apiKey: "AIzaSyABYV12B7RM2ZCD2G1lFTLpgJwflJFwEXY",
        authDomain: "beal-offshore.firebaseapp.com",
        projectId: "beal-offshore",
        storageBucket: "beal-offshore.firebasestorage.app",
        messagingSenderId: "1091834410162",
        appId: "1:1091834410162:web:56285433b5751e681745ab",
        measurementId: "G-CT463F3T6J"
      };

      try {
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        let allReviews = [];
        let currentSort = 'newest';
        let currentFilter = 'all';
        let searchQuery = '';

        // Load likes/dislikes from localStorage
        function getLikes(testimonialId) {
          const stored = localStorage.getItem(`likes_${testimonialId}`);
          return stored ? JSON.parse(stored) : { likes: 0, dislikes: 0, userLiked: false, userDisliked: false };
        }

        function setLikes(testimonialId, data) {
          localStorage.setItem(`likes_${testimonialId}`, JSON.stringify(data));
        }

        function likeTestimonial(testimonialId) {
          const current = getLikes(testimonialId);
          if (current.userLiked) {
            current.likes = Math.max(0, current.likes - 1);
            current.userLiked = false;
          } else {
            if (current.userDisliked) {
              current.dislikes = Math.max(0, current.dislikes - 1);
              current.userDisliked = false;
            }
            current.likes += 1;
            current.userLiked = true;
          }
          setLikes(testimonialId, current);
          renderTestimonials(allReviews);
        }

        function dislikeTestimonial(testimonialId) {
          const current = getLikes(testimonialId);
          if (current.userDisliked) {
            current.dislikes = Math.max(0, current.dislikes - 1);
            current.userDisliked = false;
          } else {
            if (current.userLiked) {
              current.likes = Math.max(0, current.likes - 1);
              current.userLiked = false;
            }
            current.dislikes += 1;
            current.userDisliked = true;
          }
          setLikes(testimonialId, current);
          renderTestimonials(allReviews);
        }

        function sortReviews(reviews, sortType) {
          const sorted = [...reviews];
          switch(sortType) {
            case 'oldest':
              return sorted.sort((a, b) => {
                const dateA = a.createdAt instanceof Date ? a.createdAt : new Date(a.createdAt);
                const dateB = b.createdAt instanceof Date ? b.createdAt : new Date(b.createdAt);
                return dateA - dateB;
              });
            case 'rating':
              return sorted.sort((a, b) => (b.rating || 0) - (a.rating || 0));
            case 'likes':
              return sorted.sort((a, b) => {
                const likesA = getLikes(a.id).likes;
                const likesB = getLikes(b.id).likes;
                return likesB - likesA;
              });
            case 'newest':
            default:
              return sorted.sort((a, b) => {
                const dateA = a.createdAt instanceof Date ? a.createdAt : new Date(a.createdAt);
                const dateB = b.createdAt instanceof Date ? b.createdAt : new Date(b.createdAt);
                return dateB - dateA;
              });
          }
        }

        function filterReviews(reviews, filterType) {
          if (filterType === 'all') return reviews;
          if (filterType === 'verified') return reviews.filter(r => r.verified);
          if (filterType === '5star') return reviews.filter(r => r.rating === 5);
          if (filterType === 'business') return reviews.filter(r => (r.company || '').trim().length > 0);
          if (filterType === 'individual') return reviews.filter(r => (r.company || '').trim().length === 0);
          if (filterType === 'recent') {
            const thirtyDaysAgo = new Date();
            thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);
            return reviews.filter(r => {
              const date = r.createdAt instanceof Date ? r.createdAt : new Date(r.createdAt);
              return date >= thirtyDaysAgo;
            });
          }
          return reviews;
        }

        function searchReviews(reviews, query) {
          if (!query) return reviews;
          const lowerQuery = query.toLowerCase();
          return reviews.filter(r => 
            (r.authorName && r.authorName.toLowerCase().includes(lowerQuery)) ||
            (r.company && r.company.toLowerCase().includes(lowerQuery)) ||
            (r.country && r.country.toLowerCase().includes(lowerQuery)) ||
            (r.reviewText && r.reviewText.toLowerCase().includes(lowerQuery))
          );
        }

        function updateStats(reviews) {
          const total = reviews.length;
          const avgRating = reviews.length > 0 
            ? (reviews.reduce((sum, r) => sum + (r.rating || 0), 0) / reviews.length).toFixed(1)
            : '0.0';
          const verified = reviews.filter(r => r.verified).length;
          const countries = new Set(reviews.map(r => r.country).filter(c => c)).size;

          document.getElementById('totalReviews').textContent = total;
          document.getElementById('avgRating').textContent = avgRating;
          document.getElementById('verifiedCount').textContent = verified;
          document.getElementById('countriesCount').textContent = countries;
        }

        function renderTestimonials(reviews) {
          const container = document.getElementById('testimonials-container');
          
          if (reviews.length === 0) {
            container.innerHTML = `
              <div class="bg-white rounded-xl border border-gray-200 p-12 text-center">
                <i class="fas fa-comments text-gray-300 text-5xl mb-4"></i>
                <h3 class="text-xl font-semibold text-gray-900 mb-2">No Testimonials Found</h3>
                <p class="text-gray-600">Try adjusting your search or filter criteria.</p>
              </div>
            `;
            return;
          }

          const sortedReviews = sortReviews(reviews, currentSort);
          
          container.innerHTML = sortedReviews.map((r, index) => {
            const stars = '‚≠ê'.repeat(r.rating || 0);
            const emptyStars = '‚òÜ'.repeat(5 - (r.rating || 0));
            const date = r.createdAt.toLocaleDateString('en-US', { 
              year: 'numeric', 
              month: 'long', 
              day: 'numeric' 
            });
            const readingTime = Math.ceil((r.reviewText || '').split(' ').length / 200);
            const likesData = getLikes(r.id);
            const likeCount = (r.likeCount === 0 || r.likeCount) ? Number(r.likeCount) : null;
            const likeCountHtml = Number.isFinite(likeCount)
              ? `<span class="text-sm text-gray-600 flex items-center gap-1">
                   <i class="fas fa-heart text-red-500"></i>
                   <span class="font-medium">${likeCount}</span>
                 </span>`
              : '';
            const audienceType = (r.company || '').trim().length > 0 ? 'Business' : 'Individual';
            const audienceBadgeClass = audienceType === 'Business'
              ? 'bg-blue-50 text-blue-700 border-blue-200'
              : 'bg-gray-50 text-gray-700 border-gray-200';
            
            return `
              <article 
                class="testimonial-card bg-white rounded-xl border border-gray-200 p-6 md:p-8 shadow-sm"
                itemscope 
                itemtype="https://schema.org/Review"
              >
                <div class="flex items-start justify-between mb-4">
                  <div class="flex items-start gap-4 flex-1">
                    ${r.authorImage ? `
                      <img 
                        src="${r.authorImage}" 
                        alt="${r.authorName}" 
                        class="w-16 h-16 rounded-full object-cover border-2 border-gray-200 shadow-sm"
                        itemprop="image"
                        onerror="this.onerror=null; this.style.display='none'; this.nextElementSibling.style.display='flex';"
                      >
                      <div class="w-16 h-16 rounded-full bg-gradient-to-br from-purple-100 to-indigo-100 flex items-center justify-center border-2 border-gray-200 hidden">
                        <i class="fas fa-user text-purple-600 text-xl"></i>
                      </div>
                    ` : `
                      <div class="w-16 h-16 rounded-full bg-gradient-to-br from-purple-100 to-indigo-100 flex items-center justify-center border-2 border-gray-200">
                        <i class="fas fa-user text-purple-600 text-xl"></i>
                      </div>
                    `}
                    <div class="flex-1">
                      <h3 class="blog-title text-xl font-bold text-gray-900 mb-1" itemprop="author" itemscope itemtype="https://schema.org/Person">
                        <span itemprop="name">${r.authorName || 'Anonymous'}</span>
                      </h3>
                      <div class="flex items-center gap-3 mb-2 flex-wrap">
                        ${r.company ? `<span class="text-sm font-medium text-gray-700" itemprop="affiliation">${r.company}</span>` : ''}
                        ${r.country ? `<span class="text-xs text-gray-500 flex items-center"><i class="fas fa-map-marker-alt mr-1"></i>${r.country}</span>` : ''}
                      </div>
                      <div class="flex items-center gap-2 text-sm text-gray-500">
                        <time datetime="${r.createdAt.toISOString()}" itemprop="datePublished">
                          <i class="far fa-calendar mr-1"></i>${date}
                        </time>
                        <span class="text-gray-400">‚Ä¢</span>
                        <span>
                          <i class="far fa-clock mr-1"></i>${readingTime} min read
                        </span>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="mb-4">
                  <div class="flex items-center gap-2 mb-2 flex-wrap">
                    <div class="flex items-center" itemprop="reviewRating" itemscope itemtype="https://schema.org/Rating">
                      <meta itemprop="ratingValue" content="${r.rating}">
                      <meta itemprop="bestRating" content="5">
                      <meta itemprop="worstRating" content="1">
                      <span class="text-2xl">${stars}</span>
                      <span class="text-gray-400 text-lg">${emptyStars}</span>
                      <span class="ml-2 text-sm font-semibold text-gray-700">${r.rating}/5</span>
                    </div>
                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border ${audienceBadgeClass}">
                      <i class="fas ${audienceType === 'Business' ? 'fa-building' : 'fa-user'} mr-1"></i>${audienceType}
                    </span>
                    ${r.verified ? `
                      <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 border border-green-200">
                        <i class="fas fa-check-circle mr-1"></i>Verified Review
                      </span>
                    ` : ''}
                  </div>
                </div>

                <div class="prose max-w-none mb-4">
                  <p class="text-gray-700 leading-relaxed text-base" itemprop="reviewBody">
                    ${(r.reviewText || '').replace(/\n/g, '<br>')}
                  </p>
                </div>

                <div class="flex items-center justify-between pt-4 border-t border-gray-100">
                  <div class="flex items-center gap-4">
                    ${likeCountHtml}
                    <button 
                      onclick="likeTestimonial('${r.id}')" 
                      class="like-btn ${likesData.userLiked ? 'active' : ''} text-gray-500 hover:text-green-600 transition-colors text-sm flex items-center gap-1"
                    >
                      <i class="fas fa-thumbs-up"></i>
                      <span>${likesData.likes}</span>
                    </button>
                    <button 
                      onclick="dislikeTestimonial('${r.id}')" 
                      class="dislike-btn ${likesData.userDisliked ? 'active' : ''} text-gray-500 hover:text-red-600 transition-colors text-sm flex items-center gap-1"
                    >
                      <i class="fas fa-thumbs-down"></i>
                      <span>${likesData.dislikes}</span>
                    </button>
                    <button class="text-gray-500 hover:text-purple-600 transition-colors text-sm">
                      <i class="far fa-share-square mr-1"></i>Share
                    </button>
                  </div>
                  <span class="text-xs text-gray-400">Review #${index + 1}</span>
                </div>
              </article>
            `;
          }).join('');

          // Update popular reviews sidebar
          updatePopularReviews(reviews);
          updateStructuredData(reviews);
        }

        function updatePopularReviews(reviews) {
          const popular = [...reviews]
            .map(r => ({ ...r, likes: getLikes(r.id).likes }))
            .sort((a, b) => b.likes - a.likes)
            .slice(0, 3);

          const popularContainer = document.getElementById('popularReviews');
          if (popular.length === 0) {
            popularContainer.innerHTML = '<p class="text-sm text-gray-500">No reviews yet</p>';
            return;
          }

          popularContainer.innerHTML = popular.map(r => {
            const stars = '‚≠ê'.repeat(r.rating || 0);
            const audienceType = (r.company || '').trim().length > 0 ? 'Business' : 'Individual';
            return `
              <div class="border-l-4 border-purple-500 pl-3">
                <div class="flex items-center justify-between mb-1">
                  <span class="font-semibold text-sm text-gray-900">${r.authorName}</span>
                  <span class="text-xs text-yellow-500">${stars}</span>
                </div>
                <div class="flex items-center gap-2 mb-1">
                  <span class="text-[11px] px-2 py-0.5 rounded-full border border-gray-200 text-gray-700 bg-gray-50">
                    ${audienceType}
                  </span>
                </div>
                <p class="text-xs text-gray-600 text-clamp-2">${(r.reviewText || '').substring(0, 130)}...</p>
                <div class="flex items-center gap-2 mt-1 text-xs text-gray-500">
                  <i class="fas fa-thumbs-up"></i>
                  <span>${getLikes(r.id).likes} likes</span>
                </div>
              </div>
            `;
          }).join('');
        }

        function updateStructuredData(reviews) {
          const avgRating = reviews.length > 0 
            ? (reviews.reduce((sum, r) => sum + (r.rating || 0), 0) / reviews.length).toFixed(1)
            : '0.0';

          // Enhanced Organization schema with aggregate rating for AI systems
          const orgSchema = {
            "@context": "https://schema.org",
            "@type": "Organization",
            "@id": "https://beal-offshore.com/#organization",
            "name": "Beal Offshore Ltd",
            "alternateName": "Beal Offshore",
            "url": "https://beal-offshore.com",
            "logo": {
              "@type": "ImageObject",
              "url": "https://beal-offshore.com/Logo.png"
            },
            "description": "Beal Offshore Ltd provides professional offshore banking services with expertise in compliance and international transactions. Trusted by businesses worldwide.",
            "aggregateRating": {
              "@type": "AggregateRating",
              "ratingValue": avgRating,
              "reviewCount": reviews.length.toString(),
              "bestRating": "5",
              "worstRating": "1"
            },
            "review": reviews.slice(0, 20).map(r => ({
              "@type": "Review",
              "author": {
                "@type": "Person",
                "name": r.authorName || "Anonymous",
                ...(r.company ? { "affiliation": { "@type": "Organization", "name": r.company } } : {})
              },
              "reviewRating": {
                "@type": "Rating",
                "ratingValue": r.rating.toString(),
                "bestRating": "5",
                "worstRating": "1"
              },
              "reviewBody": r.reviewText,
              "datePublished": r.createdAt.toISOString().split('T')[0],
              ...(r.verified ? { "reviewAspect": "Verified Customer Review" } : {})
            })),
            "serviceType": "Offshore Banking Services",
            "areaServed": {
              "@type": "Place",
              "name": "Worldwide"
            }
          };

          // Update testimonials schema element
          const testimonialsSchemaEl = document.getElementById('testimonials-schema');
          if (testimonialsSchemaEl) {
            testimonialsSchemaEl.textContent = JSON.stringify(orgSchema);
          }

          // Enhanced BlogPosting schema for better AI understanding
          const blogSchema = {
            "@context": "https://schema.org",
            "@type": "Blog",
            "@id": "https://beal-offshore.com/testimonials#blog",
            "name": "Beal Offshore Ltd Testimonials",
            "description": "Verified client testimonials and reviews for Beal Offshore Ltd. Read authentic customer experiences from businesses worldwide who trust Beal Offshore for offshore banking services.",
            "url": "https://beal-offshore.com/testimonials",
            "inLanguage": "en-US",
            "blogPost": reviews.map(r => ({
              "@type": "BlogPosting",
              "headline": `Review by ${r.authorName}${r.company ? ` from ${r.company}` : ''} - Beal Offshore Ltd`,
              "author": {
                "@type": "Person",
                "name": r.authorName || "Anonymous",
                ...(r.company ? { "affiliation": { "@type": "Organization", "name": r.company } } : {})
              },
              "datePublished": r.createdAt.toISOString(),
              "dateModified": r.createdAt.toISOString(),
              "reviewBody": r.reviewText,
              "reviewRating": {
                "@type": "Rating",
                "ratingValue": r.rating,
                "bestRating": 5,
                "worstRating": 1
              },
              "about": {
                "@type": "Thing",
                "name": "Beal Offshore Ltd",
                "description": "Offshore Banking Services"
              }
            })),
            "publisher": {
              "@id": "https://beal-offshore.com/#organization"
            }
          };

          const blogSchemaEl = document.getElementById('blog-schema');
          if (blogSchemaEl) {
            blogSchemaEl.textContent = JSON.stringify(blogSchema);
          }

          // Add ItemList schema for better search engine understanding
          const itemListSchema = {
            "@context": "https://schema.org",
            "@type": "ItemList",
            "name": "Beal Offshore Ltd Client Testimonials",
            "description": "List of verified client testimonials and reviews for Beal Offshore Ltd",
            "itemListElement": reviews.slice(0, 10).map((r, index) => ({
              "@type": "ListItem",
              "position": index + 1,
              "item": {
                "@type": "Review",
                "author": {
                  "@type": "Person",
                  "name": r.authorName || "Anonymous"
                },
                "reviewRating": {
                  "@type": "Rating",
                  "ratingValue": r.rating,
                  "bestRating": 5,
                  "worstRating": 1
                },
                "reviewBody": r.reviewText.substring(0, 200) + "...",
                "datePublished": r.createdAt.toISOString().split('T')[0]
              }
            }))
          };

          // Create or update ItemList schema element
          let itemListEl = document.getElementById('itemlist-schema');
          if (!itemListEl) {
            itemListEl = document.createElement('script');
            itemListEl.type = 'application/ld+json';
            itemListEl.id = 'itemlist-schema';
            document.head.appendChild(itemListEl);
          }
          itemListEl.textContent = JSON.stringify(itemListSchema);
        }

        async function loadTestimonials() {
          try {
            console.log('üîç Loading testimonials...');
            
            const q = query(collection(db, 'testimonials'), where('published', '==', true));
            const querySnapshot = await getDocs(q);

            console.log('üìä Found testimonials:', querySnapshot.size);

            allReviews = [];
            querySnapshot.forEach((doc) => {
              const data = doc.data();
              allReviews.push({
                id: doc.id,
                authorName: data.authorName || '',
                company: data.company || '',
                likeCount: data.likeCount !== undefined ? data.likeCount : null,
                country: data.country || '',
                rating: data.rating || 0,
                reviewText: data.reviewText || '',
                verified: data.verified || false,
                authorImage: data.authorImage || '',
                createdAt: data.createdAt?.toDate ? data.createdAt.toDate() : (data.createdAt ? new Date(data.createdAt) : new Date())
              });
            });

            updateStats(allReviews);
            applyFiltersAndRender();

            console.log('‚úÖ Testimonials loaded successfully');
          } catch (error) {
            console.error('‚ùå Error loading testimonials:', error);
            const container = document.getElementById('testimonials-container');
            container.innerHTML = `
              <div class="bg-white rounded-xl border border-red-200 p-8 text-center">
                <i class="fas fa-exclamation-triangle text-red-500 text-4xl mb-4"></i>
                <h3 class="text-xl font-semibold text-red-900 mb-2">Error Loading Testimonials</h3>
                <p class="text-red-700">${error.message}</p>
              </div>
            `;
          }
        }

        function applyFiltersAndRender() {
          let filtered = filterReviews(allReviews, currentFilter);
          filtered = searchReviews(filtered, searchQuery);
          
          const searchResultsEl = document.getElementById('searchResults');
          const searchCountEl = document.getElementById('searchCount');
          const clearSearchBtn = document.getElementById('clearSearch');
          
          if (searchQuery) {
            if (searchResultsEl) searchResultsEl.classList.remove('hidden');
            if (searchCountEl) searchCountEl.textContent = filtered.length;
            if (clearSearchBtn) clearSearchBtn.classList.remove('hidden');
          } else {
            if (searchResultsEl) searchResultsEl.classList.add('hidden');
            if (clearSearchBtn) clearSearchBtn.classList.add('hidden');
          }
          
          renderTestimonials(filtered);
        }

        // Expose functions globally for onclick handlers
        window.likeTestimonial = likeTestimonial;
        window.dislikeTestimonial = dislikeTestimonial;

        // Search handler
        document.getElementById('searchInput').addEventListener('input', (e) => {
          searchQuery = e.target.value.trim();
          applyFiltersAndRender();
        });

        // Sort handler
        document.getElementById('sortSelect').addEventListener('change', (e) => {
          currentSort = e.target.value;
          applyFiltersAndRender();
        });

        // Filter handler
        document.querySelectorAll('[data-filter]').forEach(btn => {
          btn.addEventListener('click', (e) => {
            document.querySelectorAll('[data-filter]').forEach(b => b.classList.remove('active'));
            e.target.classList.add('active');
            currentFilter = e.target.dataset.filter;
            applyFiltersAndRender();
          });
        });

        // Clear search handler
        document.getElementById('clearSearch').addEventListener('click', () => {
          document.getElementById('searchInput').value = '';
          searchQuery = '';
          applyFiltersAndRender();
        });

        // Support SEO SearchAction (?search=) for deep linking
        try {
          const params = new URLSearchParams(window.location.search);
          const initialSearch = (params.get('search') || '').trim();
          if (initialSearch) {
            const input = document.getElementById('searchInput');
            if (input) input.value = initialSearch;
            searchQuery = initialSearch;
          }
        } catch (_) {}

        loadTestimonials();
      } catch (error) {
        console.error('‚ùå Firebase initialization error:', error);
        const container = document.getElementById('testimonials-container');
        container.innerHTML = `
          <div class="bg-white rounded-xl border border-red-200 p-8 text-center">
            <i class="fas fa-exclamation-triangle text-red-500 text-4xl mb-4"></i>
            <h3 class="text-xl font-semibold text-red-900 mb-2">Initialization Error</h3>
            <p class="text-red-700">${error.message}</p>
          </div>
        `;
      }
    </script>
  </body>
</html>
