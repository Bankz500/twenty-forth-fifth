import"./modulepreload-polyfill-B5Qt9EMX.js";import{initializeApp as f}from"https://www.gstatic.com/firebasejs/9.1.3/firebase-app.js";import{getAuth as p,onAuthStateChanged as y,signOut as I,signInWithEmailAndPassword as w}from"https://www.gstatic.com/firebasejs/9.1.3/firebase-auth.js";import{getFirestore as E,doc as m,getDoc as h,setDoc as B}from"https://www.gstatic.com/firebasejs/9.1.3/firebase-firestore.js";const b={apiKey:"AIzaSyABYV12B7RM2ZCD2G1lFTLpgJwflJFwEXY",authDomain:"beal-offshore.firebaseapp.com",projectId:"beal-offshore",storageBucket:"beal-offshore.firebasestorage.app",messagingSenderId:"1091834410162",appId:"1:1091834410162:web:56285433b5751e681745ab",measurementId:"G-CT463F3T6J"},c=f(b),d=p(c),u=E(c);y(d,async e=>{if(e){const o=m(u,"users",e.uid),t=await h(o);if(t.exists()){const n=t.data();document.getElementById("firstName").value=n.firstName||"",document.getElementById("firstName").placeholder=n.firstName||"First Name",document.getElementById("profileUsername").textContent=n.firstName||"@syndicate",document.getElementById("Deposit-account").textContent=n.deposit||"0.00",document.getElementById("Profit-wallet").textContent=n.profit||"0.00",document.getElementById("wallet").textContent=n.wallet||"0.00",document.getElementById("welcome-message").textContent=`Welcome ${n.firstName}`,document.getElementById("displayEmail").textContent=e.email}else console.log("No user document found."),alert("No user data found.")}else console.log("No user signed in. Redirecting to sign-in page."),window.location.href="login.html"});window.signOut=function(){I(d).then(()=>{alert("Signed out successfully!"),window.location.href="login.html"}).catch(e=>{alert("Error signing out: "+e.message)})};const C=document.getElementById("changePinForm");C.addEventListener("submit",e=>{e.preventDefault();const o=document.getElementById("newPin").value;if(o.length!==5||isNaN(o)){alert("Please enter a valid 5-digit PIN.");return}const t=document.getElementById("submitButton");t.disabled=!0,t.textContent="Processing...",setTimeout(()=>{document.getElementById("passwordModal").classList.remove("hidden"),t.disabled=!1,t.textContent="Change PIN"},1e3)});const r=document.getElementById("passwordConfirmForm");r.addEventListener("submit",async e=>{e.preventDefault();const o=document.getElementById("email").value,t=document.getElementById("firebasePassword").value,n=document.getElementById("newPin").value,s=r.querySelector('button[type="submit"]');s.disabled=!0,s.textContent="Processing...";try{const l=(await w(d,o,t)).user;if(l){const g=m(u,"users",l.uid);await B(g,{pin:n},{merge:!0});const i=document.createElement("div");i.textContent="PIN Change updated!",i.className="text-blue-700 text-xs text-center mt-4",r.parentElement.appendChild(i),setTimeout(()=>{document.getElementById("passwordModal").classList.add("hidden")},2e3)}}catch(a){console.error("Error updating PIN:",a),alert("Error updating PIN: "+a.message)}finally{s.disabled=!1,s.textContent="Confirm"}});
