import"./modulepreload-polyfill-B5Qt9EMX.js";import{_ as k}from"./preload-helper-D7HrI6pR.js";import{initializeApp as Z}from"https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";import{getAuth as X,onAuthStateChanged as W}from"https://www.gstatic.com/firebasejs/9.6.1/firebase-auth.js";import{getFirestore as Q,getDocs as H,collection as C,addDoc as V,serverTimestamp as ee,doc as P,getDoc as te,deleteDoc as ne}from"https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js";const ae={apiKey:"AIzaSyABYV12B7RM2ZCD2G1lFTLpgJwflJFwEXY",authDomain:"beal-offshore.firebaseapp.com",projectId:"beal-offshore",storageBucket:"beal-offshore.firebasestorage.app",messagingSenderId:"1091834410162",appId:"1:1091834410162:web:56285433b5751e681745ab",measurementId:"G-CT463F3T6J"},z=Z(ae),A=X(z),p=Q(z);window.signOut=async function(){const{signOut:e}=await k(async()=>{const{signOut:t}=await import("https://www.gstatic.com/firebasejs/9.6.1/firebase-auth.js");return{signOut:t}},[]);try{await e(A),window.location.href="admin-login.html"}catch(t){console.error("Error signing out:",t),alert("Error signing out. Please try again.")}};W(A,e=>{if(!e){window.location.href="admin-login.html";return}_()});document.getElementById("authorImage").addEventListener("change",function(e){const t=e.target.files[0],a=document.getElementById("imagePreview"),n=document.getElementById("previewImg");if(t){if(t.size>2*1024*1024){alert("Image size must be less than 2MB"),e.target.value="",a.classList.add("hidden");return}if(!t.type.startsWith("image/")){alert("Please select a valid image file"),e.target.value="",a.classList.add("hidden");return}const s=new FileReader;s.onload=function(r){n.src=r.target.result,a.classList.remove("hidden")},s.readAsDataURL(t)}else a.classList.add("hidden")});async function se(e){const t="https://api.cloudinary.com/v1_1/dmgcagkqa/image/upload",a="ASHB_profile",n=new FormData;n.append("file",e),n.append("upload_preset",a);try{const s=await fetch(t,{method:"POST",body:n});if(!s.ok)throw new Error("Image upload failed");return(await s.json()).secure_url}catch(s){throw console.error("Error uploading image:",s),s}}const F=[{authorName:"Michael Chen",company:"Global Trade Solutions Inc.",country:"Singapore",rating:5,reviewText:"Beal Offshore Ltd has been instrumental in our international expansion across Southeast Asia. Their expertise in offshore banking solutions and regulatory compliance has saved us significant time and resources. The team is professional, responsive, and truly understands the complexities of cross-border transactions. We've processed over $2M in international transfers through their platform with zero issues. Their compliance team ensured we met all regulatory requirements for our operations in multiple jurisdictions. Highly recommended for any business looking to expand internationally.",verified:!0,published:!0},{authorName:"Sarah Williams",company:"Williams Financial Group",country:"United Kingdom",rating:5,reviewText:"Outstanding service from Beal Offshore. They helped us set up our offshore account structure efficiently when we were establishing our presence in the European market. Their attention to detail and commitment to compliance is impressive - they walked us through every step of the KYC process and made it seamless. The online dashboard is intuitive, and their customer support team responds within hours, not days. We've been with them for 18 months now and couldn't be happier. Highly recommended for anyone looking for reliable offshore banking services with a personal touch.",verified:!0,published:!0},{authorName:"James Rodriguez",company:"Rodriguez Holdings",country:"United States",rating:5,reviewText:"We've been working with Beal Offshore Ltd for over two years now, and they've consistently exceeded our expectations. As a family office managing assets across multiple countries, we needed a bank that understood international wealth management. Their team is knowledgeable, professional, and always available when we need assistance - even during off-hours. The platform is user-friendly and the transaction processing is seamless. What impressed us most was their proactive approach to compliance - they keep us informed about regulatory changes that might affect our accounts. This level of service is rare in offshore banking.",verified:!0,published:!0},{authorName:"Emma Thompson",company:"Thompson Enterprises",country:"Canada",rating:5,reviewText:"Beal Offshore has transformed how we manage our international finances. The offshore account setup was straightforward, and their compliance team ensured everything was done correctly from day one. We were initially concerned about the complexity of offshore banking, but their team made the entire process transparent and easy to understand. Their customer support is top-notch - they've helped us navigate currency conversions, international wire transfers, and even provided advice on tax-efficient structures. We appreciate their transparency throughout the process. After 3 years, we still feel like valued clients, not just account numbers.",verified:!0,published:!0},{authorName:"David Kim",company:"Kim Capital Management",country:"South Korea",rating:5,reviewText:"Excellent offshore banking services. Beal Offshore Ltd understands the needs of international businesses and provides tailored solutions. Their platform is secure, reliable, and their team is always ready to help. We've processed millions in transactions through their system without a single security concern. The multi-currency accounts have been particularly useful for our operations across Asia-Pacific. Their compliance documentation is thorough, which gives us confidence when dealing with auditors. We've had a great experience working with them and plan to expand our relationship.",verified:!0,published:!0},{authorName:"Robert Anderson",company:"Anderson & Associates",country:"Australia",rating:5,reviewText:"I've worked with several offshore banks over the past decade, and Beal Offshore Ltd stands out for their professionalism and reliability. Their online banking platform is modern and secure - I can manage all my accounts from anywhere in the world. The transaction fees are competitive, and more importantly, they're transparent about all costs upfront. Their support team has helped me with everything from setting up beneficiary accounts to understanding tax implications. The fact that they're fully licensed and regulated gives me peace of mind. I've recommended them to several colleagues in the financial services industry.",verified:!0,published:!0},{authorName:"Maria Garcia",company:"Garcia International Trading",country:"Spain",rating:5,reviewText:"Beal Offshore Ltd has been our banking partner for our import-export business for the past 3 years. Their multi-currency accounts have been essential for our operations across Europe and Latin America. The wire transfer process is fast and reliable - we've never experienced delays or issues. Their compliance team is thorough but efficient, which is exactly what we need. The online platform allows us to track all transactions in real-time, and the reporting features help us with our accounting. Their customer service is exceptional - they speak multiple languages and understand international business needs. We couldn't operate our business as efficiently without them.",verified:!0,published:!0},{authorName:"Thomas Müller",company:"Müller Tech Solutions",country:"Germany",rating:5,reviewText:"As a technology company expanding globally, we needed a banking partner that could keep up with our fast-paced growth. Beal Offshore Ltd has been exactly that. They set up our corporate accounts quickly and have supported us through multiple funding rounds. Their platform integrates well with our accounting software, saving us hours of manual work. The team understands the unique needs of tech companies - they've helped us with everything from investor relations to payroll for our international team. Their security measures are top-tier, which is crucial for a tech company. Highly professional and reliable.",verified:!0,published:!0},{authorName:"Jennifer Lee",company:"Lee Investment Partners",country:"Hong Kong",rating:5,reviewText:"Beal Offshore Ltd has been our preferred banking partner for managing our clients' offshore investments. Their expertise in wealth management and their understanding of different regulatory environments is impressive. The platform is sophisticated yet user-friendly, and their reporting capabilities are excellent for our compliance requirements. They've helped us structure accounts for clients across multiple jurisdictions while ensuring full regulatory compliance. Their team is responsive and always willing to go the extra mile. We've been with them for 4 years and have never had a reason to look elsewhere. They truly understand the needs of investment professionals.",verified:!0,published:!0},{authorName:"Ahmed Hassan",company:"Hassan Trading Group",country:"United Arab Emirates",rating:5,reviewText:"Beal Offshore Ltd has been instrumental in our business expansion across the Middle East and Africa. Their understanding of regional banking requirements and their ability to facilitate transactions across different currencies has been invaluable. The account setup process was smooth, and their compliance team ensured we met all regulatory requirements. Their online platform works perfectly even with slower internet connections, which is important for our operations in remote areas. The customer support team is available 24/7 and has helped us resolve issues quickly. Their commitment to security and compliance gives us confidence in every transaction. Excellent service overall.",verified:!0,published:!0},{authorName:"Sophie Martin",company:"Martin Real Estate Holdings",country:"France",rating:5,reviewText:"We've been using Beal Offshore Ltd for our international real estate investments for over 5 years. Their expertise in handling large transactions and their understanding of property investment structures is outstanding. They've facilitated transactions in multiple countries and currencies without any issues. The platform is secure and user-friendly, and their reporting features help us track all our investments. Their compliance team has been particularly helpful in ensuring we meet all regulatory requirements across different jurisdictions. The level of service we receive is exceptional - they treat us like partners, not just clients. We've recommended them to many colleagues in the real estate industry.",verified:!0,published:!0},{authorName:"Carlos Silva",company:"Silva Manufacturing Corp",country:"Brazil",rating:5,reviewText:"Beal Offshore Ltd has transformed our international operations. As a manufacturing company with suppliers and customers across multiple continents, we needed a banking partner that could handle complex international transactions. They've exceeded our expectations in every way. Their multi-currency accounts have saved us significant money on currency conversions, and their wire transfer service is fast and reliable. The online platform is excellent - we can manage all our accounts and transactions from our office in São Paulo. Their customer support team speaks Portuguese, which makes communication much easier. They've been our banking partner for 2 years, and we plan to continue working with them as we expand further.",verified:!0,published:!0}];function E(e,t){return Math.floor(Math.random()*(t-e+1))+e}function O(){return E(75,300)}function K(){const e=E(2019,2025),t=E(0,11),a=new Date(e,t+1,0).getDate(),n=E(1,a),s=E(10,16),r=E(0,59),i=E(0,59);return new Date(e,t,n,s,r,i)}function M(e){return String(e||"").toLowerCase().replace(/\s+/g," ").trim()}function ie(e){if(!e)return"";if(e instanceof Date)return String(e.getTime());if(typeof e.toDate=="function")return String(e.toDate().getTime());if(typeof e=="number")return String(e);if(typeof e=="string"){const t=Date.parse(e);return Number.isFinite(t)?String(t):e}if(typeof e=="object"&&typeof e.seconds=="number"){const t=typeof e.nanoseconds=="number"?e.nanoseconds:0;return String(e.seconds*1e3+Math.floor(t/1e6))}try{const t=new Date(e).getTime();return Number.isFinite(t)?String(t):""}catch{return""}}function R(e){return[M(e.authorName),M(e.reviewText),ie(e.createdAt)].join("||")}function re(e){let t=2166136261;const a=String(e||"");for(let n=0;n<a.length;n++)t^=a.charCodeAt(n),t=Math.imul(t,16777619);return t>>>0}const oe=new Set(["heather","nicole","ashley","lauren","jessica","kayla","stephanie","megan","danielle","courtney","alicia","kimberly","samantha","rachel","christina","erica","natalie","tiffany","vanessa","emily","monica","allison","paige","brielle","haley","jenna","victoria","faith","marissa","kelsey","hannah","olivia","alexis","desiree","michelle","brooke","carly","naomi","chelsea","madeline","rachael","autumn","kristen","savannah","bianca","lillian","kayleen","sarah","emma","maria","jennifer","sophie"]),le=new Set(["michael","daniel","anthony","brian","kevin","jason","andrew","matthew","jonathan","justin","brandon","eric","nicholas","ryan","steven","joseph","tyler","adam","sean","robert","zachary","carlos","patrick","aaron","dylan","marcus","paul","trevor","joshua","nathan","corey","luke","omar","isaiah","miguel","julian","frank","victor","evan","caleb","jordan","devin","austin","raymond","blake","terrence","noah","samuel","david","ahmed","james","thomas"]);function ce(e){const t=String(e||"").trim().split(/\s+/)[0].replace(/[^a-zA-Z']/g,"").toLowerCase();return t?oe.has(t)?"female":le.has(t)?"male":null:null}function de(e,t=null){const a=encodeURIComponent(String(e||"beal-offshore")),n=re(a),s=ce(e),r=n%1e3/1e3;for(let i=0;i<12;i++){const o=i?`-${i}`:"",l=`${a}${o}`,d=(n+i*997)%1e3/1e3,y=(n+i*101)%100;let c="";if(d<.55?c=`https://randomuser.me/api/portraits/${s==="female"?"women":s==="male"||(n+i)%2?"men":"women"}/${y}.jpg`:d<.9?c=`https://api.dicebear.com/8.x/avataaars/svg?seed=${l}`:c=`https://api.dicebear.com/8.x/shapes/svg?seed=${l}`,!t||!t.has(c))return c}return r<.5?`https://api.dicebear.com/8.x/avataaars/svg?seed=${a}`:`https://api.dicebear.com/8.x/shapes/svg?seed=${a}`}function ue({count:e,existingKeys:t,existingNames:a}){const n=["Daniel Thompson","Anthony Rodriguez","Brian Anderson","Kevin Moore","Jason Taylor","Andrew White","Matthew Harris","Jonathan Clark","Justin Lewis","Brandon Walker","Eric Hall","Nicholas Young","Ryan Allen","Steven King","Joseph Wright","Tyler Lopez","Adam Scott","Sean Ramirez","Robert Campbell","Zachary Mitchell","Carlos Hernandez","Patrick O'Neill","Aaron Brooks","Dylan Foster","Marcus Green","Paul Simmons","Trevor Price","Joshua Bennett","Nathan Coleman","Corey Evans","Luke Patterson","Omar Washington","Isaiah Turner","Miguel Flores","Julian Rivera","Frank Delgado","Victor Morales","Evan Porter","Caleb Reed","Jordan Nichols","Devin Watson","Austin Grant","Raymond Cruz","Blake Henderson","Terrence Powell","Noah Kim","Samuel Baker","Heather Johnson","Nicole Ramirez","Ashley Thompson","Lauren Mitchell","Jessica Anderson","Kayla Peterson","Stephanie Brown","Megan O'Connor","Danielle White","Courtney Lewis","Alicia Martinez","Kimberly Scott","Samantha Young","Rachel Turner","Christina Hall","Erica Moore","Natalie Brooks","Tiffany Adams","Vanessa Flores","Emily Richardson","Monica Rivera","Allison Grant","Paige Reynolds","Brielle Jackson","Haley Stewart","Jenna Sullivan","Victoria Lopez","Faith Robinson","Marissa Clark","Kelsey Bennett","Hannah Phillips","Jordan Evans","Olivia Carter","Alexis Green","Desiree Torres","Michelle Ward","Brooke Simmons","Carly Foster","Naomi Price","Chelsea Nguyen","Madeline Howard","Rachael King","Autumn Diaz","Kristen Powell","Savannah Morris","Bianca Cruz","Lillian Baker","Kayleen Murphy"],s=["Northbridge","Blue Harbor","Atlas","Summit","Cedarstone","Silverline","Evergreen","Prime","Vertex","Keystone","Oakridge","Brightwater"],r=["Capital","Holdings","Partners","Advisory","Trading","Logistics","Ventures","Group","Enterprises","Management","Solutions","Industries"],i=["United States","United Kingdom","Canada","Australia","Germany","France","Spain","Italy","Singapore","Hong Kong","United Arab Emirates","South Africa","Netherlands","Switzerland","Sweden","Norway","Ireland","Brazil","Mexico","Japan"],o=["Beal Offshore Ltd has been excellent for our international banking needs. Highly professional and reliable service.","Great experience with Beal Offshore Ltd. Their platform is user-friendly and customer support is responsive.","We've been using Beal Offshore Ltd for offshore banking and are very satisfied. Fast transactions and excellent service.","Beal Offshore Ltd made our offshore account setup seamless. The team is knowledgeable and always available to help.","Outstanding service from Beal Offshore Ltd. Their compliance guidance and international transfer capabilities are top-notch.","We chose Beal Offshore Ltd for our global operations and couldn't be happier. Professional, secure, and efficient.","Beal Offshore Ltd provides excellent offshore banking solutions. The platform is intuitive and transactions are processed quickly.","Highly recommend Beal Offshore Ltd for international banking. Their customer service is exceptional and the process is transparent.","Our experience with Beal Offshore Ltd has been outstanding. They understand international business needs and deliver consistently.","Beal Offshore Ltd has been our trusted banking partner for offshore operations. Reliable, secure, and professional service.","Excellent offshore banking services from Beal Offshore Ltd. The account setup was smooth and ongoing support is great.","We've been working with Beal Offshore Ltd for international transactions. Their platform is secure and easy to use.","Beal Offshore Ltd offers reliable offshore banking with excellent customer support. Highly satisfied with their services.","Great offshore banking partner. Beal Offshore Ltd provides fast, secure transactions and professional guidance.","Beal Offshore Ltd has exceeded our expectations. Their international banking solutions are comprehensive and reliable.","Professional and efficient service from Beal Offshore Ltd. The offshore account management is seamless and user-friendly.","We appreciate Beal Offshore Ltd's expertise in offshore banking. Their compliance support and platform are excellent.","Beal Offshore Ltd provides outstanding offshore banking services. Fast processing, secure platform, and great support.","Our offshore banking experience with Beal Offshore Ltd has been excellent. They make international operations easy.","Beal Offshore Ltd is a reliable offshore banking partner. Their team is professional and the platform is intuitive.","Excellent service from Beal Offshore Ltd. They handle our international banking needs with professionalism and efficiency.","Beal Offshore Ltd offers top-tier offshore banking solutions. The account setup was quick and the service is outstanding.","We've been very satisfied with Beal Offshore Ltd. Their offshore banking platform is secure and transactions are fast.","Beal Offshore Ltd provides excellent international banking services. Highly professional team and reliable platform.","Great offshore banking experience with Beal Offshore Ltd. Their customer support is responsive and the service is excellent.","Beal Offshore Ltd has been instrumental in our international operations. Professional service and secure platform.","Outstanding offshore banking partner. Beal Offshore Ltd offers reliable services with excellent customer support.","We highly recommend Beal Offshore Ltd for offshore banking. Their platform is user-friendly and service is professional.","Beal Offshore Ltd provides comprehensive offshore banking solutions. Fast, secure, and reliable international transactions.","Excellent offshore banking services from Beal Offshore Ltd. The team is knowledgeable and always ready to assist."],l=o.concat((Array.isArray(F)?F:[]).map(u=>u&&u.reviewText?String(u.reviewText):"").filter(Boolean)),d=[],y=500;let c=0;const m=new Set,x=new Set(t||[]),g=new Set(a||[]);for(;d.length<e&&c<y;){c++;let u=E(0,n.length-1),f=0;for(;m.has(u)&&f<50;)u=E(0,n.length-1),f++;const h=n[u],w=M(h);if(m.size<n.length*.8&&g.has(w))continue;const v=`${s[E(0,s.length-1)]} ${r[E(0,r.length-1)]}`,b=i[E(0,i.length-1)],B=Math.random()<.85?5:4,D=l.length?l[E(0,l.length-1)]:o[E(0,o.length-1)],T={authorName:h,company:v,country:b,rating:B,reviewText:D,verified:!0,published:!0,createdAt:K()},I=R(T);x.has(I)||(d.push(T),m.add(u),g.add(w),x.add(I))}return d}document.getElementById("addSamplesBtn").addEventListener("click",async()=>{const e=document.getElementById("addSamplesBtn");e.disabled=!0,e.innerHTML='<i class="fas fa-spinner fa-spin mr-2"></i>Adding samples...';try{if(!A.currentUser)throw new Error("Please log in first");const a=await H(C(p,"testimonials")),n=new Set,s=new Set;a.forEach(c=>{const m=c.data()||{};n.add(R(m)),m.authorName&&s.add(M(m.authorName))});let r=0,i=0;const o=new Set,l=new Set,y=ue({count:24,existingKeys:n,existingNames:s});for(const c of y)try{const m=c.authorImage||de(c.authorName,l),x=O(),g={...c,authorImage:m,likeCount:x,createdAt:c.createdAt||K()},u=R(g);if(n.has(u)||o.has(u)){i++;continue}await V(C(p,"testimonials"),g),r++,o.add(u),n.add(u),g.authorName&&s.add(M(g.authorName)),g.authorImage&&l.add(g.authorImage)}catch(m){console.error("Error adding testimonial:",m)}if(r>0)i>0?S(`Successfully added ${r} sample testimonials. Skipped ${i} duplicates.`):S(`Successfully added ${r} sample testimonials!`);else{const c=i>0?` Skipped ${i} duplicates.`:"";L(`No new sample testimonials were added.${c} Click again to generate a different random set.`)}_()}catch(t){L("Error adding sample testimonials: "+t.message)}finally{e.disabled=!1,e.innerHTML='<i class="fas fa-sparkles mr-2"></i>Add Sample Testimonials'}});document.getElementById("testimonialForm").addEventListener("submit",async e=>{e.preventDefault();const t=document.getElementById("submitBtn");t.disabled=!0,t.innerHTML='<i class="fas fa-spinner fa-spin mr-2"></i>Adding...';try{if(!A.currentUser)throw new Error("Please log in first");let n="";const s=document.getElementById("authorImage").files[0];if(s){t.innerHTML='<i class="fas fa-spinner fa-spin mr-2"></i>Uploading image...';try{n=await se(s),console.log("Image uploaded successfully:",n)}catch(T){throw console.error("Image upload error:",T),new Error("Failed to upload image. Please try again.")}}t.innerHTML='<i class="fas fa-spinner fa-spin mr-2"></i>Saving...';const r=document.getElementById("editingTestimonialId"),i=r?r.value:"",o=document.getElementById("publishedDate"),l=o?o.value:"",d=document.getElementById("authorName"),y=document.getElementById("company"),c=document.getElementById("country"),m=document.getElementById("rating"),x=document.getElementById("reviewText"),g=document.getElementById("verified"),u=document.getElementById("published"),f=document.getElementById("likeCount");if(!d||!y||!c||!m||!x||!g||!u)throw new Error("Form elements not found. Please refresh the page.");const h={authorName:d.value.trim(),company:y.value.trim(),country:c.value.trim(),rating:parseInt(m.value),reviewText:x.value.trim(),verified:g.checked,published:u.checked};if(f){const T=String(f.value||"").trim();if(T){const I=parseInt(T,10);if(!Number.isFinite(I)||I<0)throw new Error("Like Count must be a number (0 or higher).");h.likeCount=I}else i||(h.likeCount=O())}else i||(h.likeCount=O());if(l){const T=new Date(l);h.createdAt=T}else i||(h.createdAt=ee());if(n&&(h.authorImage=n),i){const{updateDoc:T}=await k(async()=>{const{updateDoc:I}=await import("https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js");return{updateDoc:I}},[]);await T(P(p,"testimonials",i),h),S("Testimonial updated successfully!")}else await V(C(p,"testimonials"),h),S("Testimonial added successfully!");const w=document.getElementById("testimonialForm");w&&w.reset();const v=document.getElementById("imagePreview");v&&v.classList.add("hidden");const b=document.getElementById("previewImg");b&&(b.src="");const B=document.getElementById("editingTestimonialId");B&&(B.value="");const D=document.getElementById("publishedDate");D&&(D.value=""),cancelEdit(),_()}catch(a){L("Error adding testimonial: "+a.message)}finally{t.disabled=!1;const a=document.getElementById("editingTestimonialId"),n=a?a.value:"";t.innerHTML=n?'<i class="fas fa-save mr-2"></i>Update Testimonial':'<i class="fas fa-save mr-2"></i>Add Testimonial'}});async function _(){try{const e=await H(C(p,"testimonials")),t=document.getElementById("testimonialsList");if(e.empty){t.innerHTML='<p class="text-gray-500 text-center py-8">No testimonials found. Add your first testimonial above!</p>';return}const a=[];e.forEach(n=>{var r;const s=n.data();a.push({id:n.id,...s,createdAt:(r=s.createdAt)!=null&&r.toDate?s.createdAt.toDate():new Date})}),a.sort((n,s)=>{const r=n.createdAt instanceof Date?n.createdAt:new Date(n.createdAt);return(s.createdAt instanceof Date?s.createdAt:new Date(s.createdAt))-r}),t.innerHTML=a.map(n=>{const s=n.createdAt.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),r="⭐".repeat(n.rating||0),i=n.likeCount!==void 0?n.likeCount:"—";return`
                        <div class="border border-gray-200 rounded-lg p-4 ${n.published?"":"opacity-60"}">
                            <div class="flex justify-between items-start mb-2">
                                <div class="flex items-start gap-3">
                                    ${n.authorImage?`<img src="${n.authorImage}" alt="${n.authorName}" class="w-12 h-12 rounded-full object-cover border border-gray-200">`:'<div class="w-12 h-12 rounded-full bg-gray-200 flex items-center justify-center"><i class="fas fa-user text-gray-400"></i></div>'}
                                <div>
                                        <h3 class="font-semibold text-gray-900">${n.authorName}</h3>
                                        <p class="text-sm text-gray-600">${n.company} • ${n.country}</p>
                                    </div>
                                </div>
                                <div class="text-right">
                                    <div class="text-yellow-500 text-sm">${r}</div>
                                    <div class="text-xs text-gray-500 mt-1">${s}</div>
                                    <div class="text-xs text-gray-600 mt-1 flex items-center gap-1">
                                        <i class="fas fa-thumbs-up"></i> ${i}
                                    </div>
                                </div>
                            </div>
                            <p class="text-gray-700 text-sm mt-2">${n.reviewText}</p>
                            <div class="flex items-center gap-2 mt-3 text-xs">
                                ${n.verified?'<span class="bg-green-100 text-green-800 px-2 py-1 rounded">Verified</span>':""}
                                ${n.published?'<span class="bg-blue-100 text-blue-800 px-2 py-1 rounded">Published</span>':'<span class="bg-gray-100 text-gray-800 px-2 py-1 rounded">Draft</span>'}
                                <button onclick="deleteTestimonial('${n.id}')" class="text-red-600 hover:text-red-800 ml-auto">
                                    <i class="fas fa-trash"></i> Delete
                                </button>
                            </div>
                        </div>
                    `}).join("")}catch(e){console.error("Error loading testimonials:",e),document.getElementById("testimonialsList").innerHTML='<p class="text-red-500 text-center py-8">Error loading testimonials. Please refresh the page.</p>'}}window.editTestimonial=async e=>{try{if(!A.currentUser)throw new Error("Please log in first");const a=await te(P(p,"testimonials",e));if(!a.exists())throw new Error("Testimonial not found");const n=a.data(),s=document.getElementById("authorName"),r=document.getElementById("company"),i=document.getElementById("country"),o=document.getElementById("rating"),l=document.getElementById("reviewText"),d=document.getElementById("verified"),y=document.getElementById("published"),c=document.getElementById("likeCount"),m=document.getElementById("editingTestimonialId"),x=document.getElementById("publishedDate"),g=document.getElementById("previewImg"),u=document.getElementById("imagePreview"),f=document.getElementById("formTitle"),h=document.getElementById("submitBtnText"),w=document.getElementById("cancelEditBtn");if(s&&(s.value=n.authorName||""),r&&(r.value=n.company||""),i&&(i.value=n.country||""),o&&(o.value=n.rating||""),l&&(l.value=n.reviewText||""),d&&(d.checked=n.verified||!1),y&&(y.checked=n.published||!1),c&&(c.value=n.likeCount!==void 0?n.likeCount:""),m&&(m.value=e),n.createdAt&&n.createdAt.toDate&&x){const v=n.createdAt.toDate();x.value=v.toISOString().split("T")[0]}n.authorImage&&g&&(g.src=n.authorImage,u&&u.classList.remove("hidden")),f&&(f.textContent="Edit Testimonial"),h&&(h.textContent="Update Testimonial"),w&&w.classList.remove("hidden"),document.getElementById("testimonialForm").scrollIntoView({behavior:"smooth",block:"start"})}catch(t){console.error("Error loading testimonial for edit:",t),L("Error loading testimonial: "+t.message)}};window.cancelEdit=function(){const e=document.getElementById("testimonialForm");e&&e.reset();const t=document.getElementById("imagePreview");t&&t.classList.add("hidden");const a=document.getElementById("previewImg");a&&(a.src="");const n=document.getElementById("editingTestimonialId");n&&(n.value="");const s=document.getElementById("publishedDate");s&&(s.value="");const r=document.getElementById("formTitle");r&&(r.textContent="Add New Testimonial");const i=document.getElementById("submitBtnText");i&&(i.textContent="Add Testimonial");const o=document.getElementById("cancelEditBtn");o&&o.classList.add("hidden")};document.getElementById("backfillLikesBtn").addEventListener("click",async()=>{const e=document.getElementById("backfillLikesBtn");e.disabled=!0,e.innerHTML='<i class="fas fa-spinner fa-spin mr-2"></i>Assigning likes...';try{if(!A.currentUser)throw new Error("Please log in first");const{updateDoc:a}=await k(async()=>{const{updateDoc:i}=await import("https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js");return{updateDoc:i}},[]),n=await H(C(p,"testimonials"));let s=0;const r=[];n.forEach(i=>{const o=O();r.push(a(P(p,"testimonials",i.id),{likeCount:o})),s++}),await Promise.all(r),S(`Successfully assigned random like counts to ${s} testimonials!`),_()}catch(t){console.error("Error assigning like counts:",t),L("Error assigning like counts: "+t.message)}finally{e.disabled=!1,e.innerHTML='<i class="fas fa-thumbs-up mr-2"></i>Assign Random Like Counts'}});window.deleteTestimonial=async e=>{if(confirm("Are you sure you want to delete this testimonial? This action cannot be undone."))try{if(!A.currentUser)throw new Error("Please log in first");await ne(P(p,"testimonials",e)),S("Testimonial deleted successfully!"),_()}catch(t){console.error("Error deleting testimonial:",t),L("Error deleting testimonial: "+t.message)}};function S(e){const t=document.getElementById("successMessage");document.getElementById("successText").textContent=e,t.classList.remove("hidden"),setTimeout(()=>t.classList.add("hidden"),5e3)}function L(e){const t=document.getElementById("errorMessage");document.getElementById("errorText").textContent=e,t.classList.remove("hidden"),setTimeout(()=>t.classList.add("hidden"),5e3)}let N=null;async function $(){try{const e=await k(()=>import("https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js"),[]),{collection:t,query:a,orderBy:n,onSnapshot:s}=e,r=t(p,"live_chats"),i=a(r,n("lastMessageAt","desc"));s(i,async o=>{const l=[];let d=0;o.forEach(y=>{const c=y.data();l.push({id:y.id,...c})});for(const y of l){const c=await G(y.id);d+=c}J(l),we(d)},o=>{console.error("Live chat listener error:",o);const l=(o==null?void 0:o.message)||String(o);document.getElementById("chatsList").innerHTML=`<p class="text-red-600 text-center py-8">Live chat failed to load: ${l}</p>`,L("Live chat failed to load: "+l)})}catch(e){console.error("Error loading chats:",e),document.getElementById("chatsList").innerHTML='<p class="text-red-500 text-center py-8">Error loading chats. Please refresh.</p>'}}async function G(e){try{const t=await k(()=>import("https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js"),[]),{collection:a,query:n,where:s,getDocs:r}=t,i=a(p,"live_chats",e,"messages"),o=n(i,s("read","==",!1),s("sender","==","user"));return(await r(o)).size}catch{return 0}}function J(e){const t=document.getElementById("chatsList");if(e.length===0){t.innerHTML='<p class="text-gray-500 text-center py-8">No active chats yet.</p>';return}t.innerHTML=e.map(a=>{var s;const n=(s=a.lastMessageAt)!=null&&s.toDate?a.lastMessageAt.toDate().toLocaleDateString():"N/A";return`
                    <div class="border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition ${N===a.id?"bg-blue-50 border-blue-300":""}">
                        <div class="flex justify-between items-start">
                            <div class="flex-1 cursor-pointer" onclick="selectChat('${a.id}', '${a.userName||"User"}')">
                                <h3 class="font-semibold text-gray-900">${a.userName||"User"}</h3>
                                <p class="text-sm text-gray-600">${a.userId||"Unknown"}</p>
                                <p class="text-xs text-gray-500 mt-1">Last message: ${n}</p>
                            </div>
                            <div class="flex items-center gap-2">
                                <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${a.status==="open"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}">
                                    ${a.status||"open"}
                                </span>
                                <span id="unreadBadge-${a.id}" class="bg-red-500 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center hidden">0</span>
                                <button onclick="event.stopPropagation(); deleteChat('${a.id}')" class="text-red-500 hover:text-red-700 p-1" title="Delete Chat">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                `}).join(""),e.forEach(async a=>{const n=await G(a.id),s=document.getElementById(`unreadBadge-${a.id}`);s&&(n>0?(s.textContent=n,s.classList.remove("hidden")):s.classList.add("hidden"))})}async function me(e,t){N=e;const a=await he();J(a),await fe(e,t)}async function he(){try{const e=await k(()=>import("https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js"),[]),{collection:t,query:a,orderBy:n,getDocs:s}=e,r=t(p,"live_chats"),i=a(r,n("lastMessageAt","desc")),o=await s(i),l=[];return o.forEach(d=>{l.push({id:d.id,...d.data()})}),l}catch{return[]}}async function fe(e,t){try{const a=await k(()=>import("https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js"),[]),{collection:n,query:s,orderBy:r,onSnapshot:i,getDocs:o}=a,l=n(p,"live_chats",e,"messages"),d=s(l,r("timestamp","asc")),y=document.getElementById("chatSection"),c=document.getElementById("chatView");c&&c.remove();const m=document.createElement("div");m.id="chatView",m.className="mt-6 border-t border-gray-200 pt-6",m.innerHTML=`
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-semibold">Chat with ${t}</h3>
                        <button onclick="closeChatView()" class="text-gray-500 hover:text-gray-700">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div id="chatMessagesArea" class="bg-gray-50 rounded-lg p-4 h-96 overflow-y-auto mb-4 space-y-3">
                        <!-- Messages will appear here -->
                    </div>
                    <div class="flex gap-2">
                        <input type="text" id="adminReplyInput" placeholder="Type your reply..." 
                            class="flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                            style="font-size: 16px !important;">
                        <button onclick="sendAdminReply('${e}')" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg">
                            <i class="fas fa-paper-plane mr-2"></i>Send
                        </button>
                    </div>
                `,y.appendChild(m);const x=await o(d),g=document.getElementById("chatMessagesArea");if(g){g.innerHTML="";const u=[];x.forEach(f=>{const h={id:f.id,...f.data()};u.push(h)}),u.sort((f,h)=>{var b,B;const w=(b=f.timestamp)!=null&&b.toDate?f.timestamp.toDate().getTime():f.timestamp||0,v=(B=h.timestamp)!=null&&B.toDate?h.timestamp.toDate().getTime():h.timestamp||0;return w-v}),u.forEach(f=>{j(f)}),setTimeout(()=>{g.scrollTop=g.scrollHeight},100)}i(d,u=>{const f=document.getElementById("chatMessagesArea");if(!f)return;const h=new Set;f.querySelectorAll("[data-msg-id]").forEach(v=>{h.add(v.getAttribute("data-msg-id"))});const w=[];u.forEach(v=>{const b=v.id;if(!h.has(b)){const B={id:b,...v.data()};w.push(B)}}),w.sort((v,b)=>{var T,I;const B=(T=v.timestamp)!=null&&T.toDate?v.timestamp.toDate().getTime():v.timestamp||0,D=(I=b.timestamp)!=null&&I.toDate?b.timestamp.toDate().getTime():b.timestamp||0;return B-D}),w.forEach(v=>{j(v)}),setTimeout(()=>{f.scrollTop=f.scrollHeight},100)}),await ve(e)}catch(a){console.error("Error loading chat messages:",a)}}function j(e){const t=document.getElementById("chatMessagesArea");if(!t)return;const a=e.id||`msg_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;if(t.querySelector(`[data-msg-id="${a}"]`))return;const n=e.sender==="admin";let s="";const r=e.imageBase64||e.imageUrl;r&&(s=`
                    <div class="mb-2 rounded-lg overflow-hidden shadow-md">
                        <img src="${r}" alt="Shared image" class="max-w-full max-h-64 cursor-pointer hover:opacity-90 rounded transition-opacity" onclick="window.open('${r}', '_blank')">
                    </div>
                `);const i=document.createElement("div");i.className=`flex ${n?"justify-end":"justify-start"} mb-3`,i.setAttribute("data-msg-id",a),i.innerHTML=`
                <div class="max-w-[80%] ${n?"bg-blue-600 text-white":"bg-white text-gray-900 border border-gray-200"} rounded-lg p-3 shadow-sm">
                    ${s}
                    ${e.text?`<div class="text-sm ${n?"text-white":"text-gray-800"}">${ge(e.text)}</div>`:""}
                    <div class="text-xs mt-1.5 ${n?"text-blue-100 opacity-80":"text-gray-500"}">${pe(e.timestamp)}</div>
                </div>
            `,t.appendChild(i)}function ge(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}function pe(e){return e?(e.toDate?e.toDate():new Date(e)).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):""}async function ye(e){const t=document.getElementById("adminReplyInput"),a=t.value.trim();if(!(!a||!e))try{const n=await k(()=>import("https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js"),[]),{collection:s,addDoc:r,serverTimestamp:i,updateDoc:o,doc:l}=n;await r(s(p,"live_chats",e,"messages"),{text:a,sender:"admin",timestamp:i(),read:!1}),await o(l(p,"live_chats",e),{lastMessageAt:i(),status:"open"}),t.value=""}catch(n){console.error("Error sending reply:",n),L("Failed to send message. Please try again.")}}async function ve(e){try{const t=await k(()=>import("https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js"),[]),{collection:a,query:n,where:s,getDocs:r,updateDoc:i,doc:o}=t,l=a(p,"live_chats",e,"messages"),d=n(l,s("read","==",!1),s("sender","==","user"));(await r(d)).forEach(async c=>{await i(o(p,"live_chats",e,"messages",c.id),{read:!0})}),$()}catch(t){console.error("Error marking as read:",t)}}function Y(){const e=document.getElementById("chatView");e&&e.remove(),N=null}function we(e){const t=document.getElementById("adminChatBadge");t&&(e>0?(t.textContent=e,t.classList.remove("hidden")):t.classList.add("hidden"))}W(A,e=>{e&&$()});async function be(e){if(confirm("Are you sure you want to delete this chat? This action cannot be undone."))try{const t=await k(()=>import("https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js"),[]),{collection:a,getDocs:n,deleteDoc:s,doc:r}=t,i=a(p,"live_chats",e,"messages"),l=(await n(i)).docs.map(d=>s(r(p,"live_chats",e,"messages",d.id)));await Promise.all(l),await s(r(p,"live_chats",e)),N===e&&Y(),$(),S("Chat deleted successfully!")}catch(t){console.error("Error deleting chat:",t),L("Failed to delete chat. Please try again.")}}function Te(e){document.getElementById("testimonialsSection").classList.add("hidden"),document.getElementById("chatSection").classList.add("hidden"),document.querySelectorAll(".nav-item").forEach(t=>{t.classList.remove("active")}),e==="testimonials"?(document.getElementById("testimonialsSection").classList.remove("hidden"),document.querySelector('a[onclick*="testimonials"]').classList.add("active"),document.getElementById("pageTitle").textContent="Testimonials"):e==="chat"&&(document.getElementById("chatSection").classList.remove("hidden"),document.querySelector('a[onclick*="chat"]').classList.add("active"),document.getElementById("pageTitle").textContent="Live Chat",document.getElementById("chatsList").innerHTML.includes("Loading")&&$()),window.innerWidth<768&&document.querySelector(".sidebar").classList.remove("open")}var q;(q=document.getElementById("openSidebar"))==null||q.addEventListener("click",()=>{document.querySelector(".sidebar").classList.add("open")});var U;(U=document.getElementById("closeSidebar"))==null||U.addEventListener("click",()=>{document.querySelector(".sidebar").classList.remove("open")});window.showSection=Te;window.selectChat=me;window.sendAdminReply=ye;window.closeChatView=Y;window.deleteChat=be;
