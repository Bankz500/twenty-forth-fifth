import"./modulepreload-polyfill-B5Qt9EMX.js";import{b as B,a as L,l as ie,c as Q,u as se,g as R,d as T,e as $,h as ae,f as le,m as re,n as Y,o as de,s as Z,p as ce,j as K}from"./firebase-client-DvgkFHPb.js";import"./firebase-config-C56FTJjz.js";window.auth=B;window.db=L;window.firestoreHelpers={addDoc:le,collection:ae,serverTimestamp:$,doc:T,getDoc:R,updateDoc:se,setDoc:Q,deleteDoc:ie};function me(e){try{let o=document.getElementById("firebaseStatusBanner");o||(o=document.createElement("div"),o.id="firebaseStatusBanner",o.className="fixed top-0 left-0 right-0 z-50 bg-red-600 text-white text-sm px-4 py-3 shadow-lg",document.body.appendChild(o)),o.textContent=e}catch{}}window.addEventListener("unhandledrejection",e=>{var n;const o=((n=e==null?void 0:e.reason)==null?void 0:n.message)||String((e==null?void 0:e.reason)||"");(o.includes("auth/internal-error")||o.includes("Could not reach Cloud Firestore backend"))&&me("Connection issue: Firebase could not be reached (offline/VPN/adblock). Please check your internet connection and try again.")});document.addEventListener("DOMContentLoaded",()=>{var e;try{const o=re(),n=document.getElementById("user-first-name"),t=((e=B.currentUser)==null?void 0:e.uid)||null;if(!o||!n||n.textContent.trim()||!t)return;if(o.__uid&&o.__uid!==t){Y();return}o.__uid===t&&ge(o)}catch{}},{passive:!0});let A=null,P=null,q=null,k=null;function U(){const e=document.getElementById("debitCardProgressWrap"),o=document.getElementById("debitCardProgressStatus"),n=document.getElementById("debitCardProgressBar"),t=document.getElementById("debitCardProgressText");if(!e||!o||!n||!t)return;const s=q&&(q.status||"active")==="active",a=((k==null?void 0:k.status)||"").toLowerCase();if(s){e.classList.add("hidden");return}if(a==="pending"){e.classList.remove("hidden"),o.textContent="Pending approval",n.style.width="60%",t.textContent="Your debit card request is being reviewed.";return}e.classList.add("hidden")}function ue(e){try{if(A){try{A()}catch{}A=null}if(P){try{P()}catch{}P=null}q=null,k=null;const o=T(L,"debit_cards",e.uid),n=T(L,"debit_card_applications",e.uid);A=K(o,t=>{q=t.exists()?t.data():null,U()},()=>{q=null,U()}),P=K(n,t=>{k=t.exists()?t.data():null,U()},()=>{k=null,U()})}catch(o){console.warn("Debit card progress setup failed",o)}}function ee(e,o){const n=o.split("|").map(p=>p.trim()),t=n[0]||"",s=n[1]||"",a=n[2]||"",r=n[3]||"",l=n[4]||"",d=n[5]||"",c=n.slice(6).join("|")||"";e.dataset.transactionType=t,e.dataset.transactionRecipient=s,e.dataset.transactionAmount=a,e.dataset.transactionTime=r,e.dataset.transactionDate=l,e.dataset.transactionReference=d,e.dataset.transactionNotes=c;const f=e.querySelector(".transaction-description"),g=e.querySelector(".transaction-recipient"),x=e.querySelector(".transaction-type"),u=e.querySelector(".transaction-amount"),i=e.querySelector(".transaction-date"),h=e.querySelector(".transaction-reference"),E=e.querySelector(".meta-row"),C=e.querySelector(".separator"),y=e.querySelector(".transaction-avatar"),b=e.querySelector(".transaction-avatar-text");f&&(f.textContent=t),g&&(g.textContent=s),x&&(x.textContent=t),u&&(u.textContent=a),i&&(i.textContent=l),h&&(h.textContent=d);const m=e.querySelector(".mobile-transaction-item");if(m){const p=m.querySelector(".mobile-transaction-description"),w=m.querySelector(".mobile-transaction-time"),S=m.querySelector(".mobile-transaction-amount"),v=m.querySelector(".mobile-transaction-icon"),I=m.querySelector(".transaction-icon-text-mobile");if(p&&(p.textContent=t||s||"Transaction"),w&&(w.textContent=r||l||"-"),S){S.textContent=a||"-";const N=a&&(a.startsWith("+")||a.includes("credit")||a.includes("deposit"));S.className="mobile-transaction-amount transaction-amount-mobile "+(N?"credit":"debit")}if(v&&I){const N=(t||"").toLowerCase();N.includes("cashback")||N.includes("refund")?(v.style.backgroundColor="#e0f2fe",I.textContent="₦",I.style.color="#0369a1"):N.includes("mtn")||N.includes("data")?(v.style.backgroundColor="#fef3c7",I.textContent="MTN",I.style.fontSize="10px",I.style.color="#1e40af"):N.includes("savings")||N.includes("deposit")?(v.style.backgroundColor="#ede9fe",I.textContent="K.",I.style.fontSize="12px",I.style.color="#7c3aed"):(v.style.backgroundColor="#e0f2fe",I.textContent="₦",I.style.color="#0369a1")}}if(E){const p=!!t&&t!=="-",w=!!l&&l!=="-";p||w?(E.classList.remove("hidden"),C&&(p&&w?C.classList.remove("hidden"):C.classList.add("hidden"))):E.classList.add("hidden")}if(y&&b){const p=(t||"").toLowerCase();let w="TX",S="bg-blue-50",v="text-blue-700";p.includes("deposit")?(w="DP",S="bg-blue-50",v="text-blue-700"):p.includes("transfer")?(w="TF",S="bg-indigo-50",v="text-indigo-700"):p.includes("refund")?(w="RF",S="bg-amber-50",v="text-amber-700"):p.includes("reversal")&&(w="RV",S="bg-rose-50",v="text-rose-700"),b.textContent=w,y.className="w-12 h-12 rounded-full flex items-center justify-center transaction-avatar font-semibold text-sm "+S+" "+v}}function pe(e){const o=document.getElementById("transactionDetailModal");if(!o||!e)return;const n=e.dataset.transactionType||"",t=e.dataset.transactionRecipient||"",s=e.dataset.transactionAmount||"",a=e.dataset.transactionTime||"",r=e.dataset.transactionDate||"",l=e.dataset.transactionReference||"",d=e.dataset.transactionNotes||"";let c=r;r&&a?c=`On ${r} at ${a}`:r?c=r:a&&(c=a);const f=s&&(s.startsWith("+")||s.includes("credit")||s.includes("deposit"));document.getElementById("detail-amount").textContent=s||"₦0.00",document.getElementById("detail-amount").className="transaction-detail-amount"+(f?" credit":""),document.getElementById("detail-type").textContent=(n||t||"Transaction").toUpperCase(),document.getElementById("detail-date").textContent=c||"-",document.getElementById("detail-description").textContent=d||n||t||"-",document.getElementById("detail-method").textContent=n||"-",document.getElementById("detail-reference").textContent=l||"-",document.getElementById("detail-from").textContent=t||"Kuda";const g=(n||"").toLowerCase();let x="Savings";g.includes("cashback")?x="Cashback":g.includes("mtn")||g.includes("data")?x="Data":g.includes("savings")&&(x="Savings"),document.getElementById("detail-category").textContent=x,window.innerWidth<768&&(o.classList.add("active"),document.body.style.overflow="hidden")}function F(e){if(window.innerWidth>=768)return;const o=e.target.closest(".mobile-transaction-item");if(!o)return;const n=o.dataset.transactionId;if(!n)return;const t=document.getElementById(n);t&&t.dataset.transactionType&&t.dataset.transactionType!==""&&(e.preventDefault(),e.stopPropagation(),pe(t))}let j=!1,M=null;de(B,async e=>{if(M&&(clearTimeout(M),M=null),e){j=!0,console.log("User is logged in:",e.uid);const o=document.querySelectorAll(".accounts-section, #history-container");o.forEach(n=>{n&&(n.style.opacity="0.6")}),await fe(e),Ce(e),ue(e),o.forEach(n=>{n&&(n.style.opacity="1")})}else j||(await new Promise(o=>setTimeout(o,500)),j=!0),M=setTimeout(()=>{B.currentUser||(console.log("No user signed in. Redirecting to sign-in page."),Y(),window.location.href="login.html")},1e3)});async function fe(e){const o=T(L,"users",e.uid),n=await R(o);let t=null;if(n.exists())t=n.data()||{};else{let u=null;try{const y=(e.email||"").trim();if(y){const b=T(L,"users",y),m=await R(b);m.exists()&&(u=m.data()||{})}}catch(y){console.warn("Legacy email-doc migration skipped/failed:",y)}const i=u&&typeof u=="object"?u:{},h=e.displayName||"",E=i.firstName||(typeof i.name=="string"?i.name.split(" ")[0]:"")||(typeof i.fullName=="string"?i.fullName.split(" ")[0]:"")||(h?h.split(" ")[0]:"")||(e.email||"").split("@")[0]||"",C={...i,email:i.email||e.email||null,firstName:i.firstName||E||null,approvalStatus:i.approvalStatus||"approved",isApproved:typeof i.isApproved=="boolean"?i.isApproved:!0,approvedAt:i.approvedAt||$(),approvedBy:i.approvedBy||(u?"legacy_migrated":"legacy_auto"),createdAt:i.createdAt||$(),createdAtIso:i.createdAtIso||new Date().toISOString(),migratedFrom:u?"users/{email}":null};await Q(o,C,{merge:!0}),t=C}const s=(t==null?void 0:t.approvalStatus)||null,a=typeof(t==null?void 0:t.isApproved)=="boolean"?t.isApproved:null;if(!(s==="approved"||s==null&&a!==!1)){Y();try{await Z(B)}catch{}window.location.href="login.html?pending=1";return}ce({...t||{},__uid:e.uid,__email:e.email||(t==null?void 0:t.email)||null});const l=u=>{if(!u)return"0.00";const i=typeof u=="string"?parseFloat(u.replace(/[^0-9.-]/g,""))||0:Number(u)||0;return new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(i)};document.getElementById("checking").textContent=l(t.checking),document.getElementById("savings").textContent=l(t.savings),document.getElementById("fixed").textContent=l(t.fixed),te(t);const d=document.getElementById("user-first-name"),c=typeof t.firstName=="string"&&t.firstName.trim()?t.firstName.trim():typeof t.name=="string"&&t.name.trim()?t.name.trim().split(" ")[0]:typeof t.fullName=="string"&&t.fullName.trim()?t.fullName.trim().split(" ")[0]:e.email?e.email.split("@")[0]:"";d&&(d.textContent=c||"");const f=document.getElementById("cardholder-name"),g=document.getElementById("modal-cardholder-name");let x="";t.firstName&&t.lastName?x=`${String(t.firstName).toUpperCase()} ${String(t.lastName).toUpperCase()}`:t.firstName?x=String(t.firstName).toUpperCase():t.fullName?x=String(t.fullName).toUpperCase():t.name&&(x=String(t.name).toUpperCase()),x&&(f&&(f.textContent=x),g&&(g.textContent=x)),setTimeout(()=>{let u=!1,i=0;for(let C=1;C<=20;C++){const y=document.getElementById(`history${C}`);if(y){const b=t[`history${C}`]||"";if(b&&b.trim()!==""){if(ee(y,b),i<10){y.style.display="block";const m=y.querySelector(".mobile-transaction-item");m&&(m.style.display="flex"),i++}else{y.style.display="none";const m=y.querySelector(".mobile-transaction-item");m&&(m.style.display="none")}C>10&&(u=!0)}else{y.style.display="none";const m=y.querySelector(".mobile-transaction-item");m&&(m.style.display="none")}}}const h=document.getElementById("see-more");h&&(u?h.classList.remove("hidden"):h.classList.add("hidden"));const E=document.getElementById("recent-transactions");E&&(E.removeEventListener("click",F),E.addEventListener("click",F,{passive:!0}))},100),setTimeout(()=>{const u=document.getElementById("pending1"),i=document.getElementById("pending2"),h=document.getElementById("pending3"),E=document.getElementById("pending4"),C=document.getElementById("pending5"),y=document.getElementById("pending-list");function b(p,w){const S=w.split("|").map(oe=>oe.trim()),v=S[0]||"",I=S[1]||"",N=S[2]||"";S[3];const ne=S[4]||"";S[5];const H=p.querySelector(".pending-description"),V=p.querySelector(".pending-recipient"),z=p.querySelector(".pending-type"),O=p.querySelector(".pending-amount"),W=p.querySelector(".pending-date"),J=p.querySelector(".pending-avatar"),D=p.querySelector(".pending-avatar-text");H&&(H.textContent=v),V&&(V.textContent=I),z&&(z.textContent=v),O&&(O.textContent=N),W&&(W.textContent=ne),J&&D&&(D.textContent="PN",J.className="w-12 h-12 rounded-full flex items-center justify-center pending-avatar font-semibold text-sm bg-orange-50 text-orange-700")}function m(p){!y||!p||y.appendChild(p)}t.pending1&&t.pending1.trim()!==""&&(u.classList.remove("hidden"),b(u,t.pending1),m(u)),t.pending2&&t.pending2.trim()!==""&&(i.classList.remove("hidden"),b(i,t.pending2),m(i)),t.pending3&&t.pending3.trim()!==""&&(h.classList.remove("hidden"),b(h,t.pending3),m(h)),t.pending4&&t.pending4.trim()!==""&&(E.classList.remove("hidden"),b(E,t.pending4),m(E)),t.pending5&&t.pending5.trim()!==""&&(C.classList.remove("hidden"),b(C,t.pending5),m(C)),t.pending1&&t.pending2&&t.pending3&&t.pending4&&t.pending5&&t.pending1.trim()!==""&&t.pending2.trim()!==""&&t.pending3.trim()!==""&&t.pending4.trim()!==""&&t.pending5.trim()!==""?document.getElementById("pending-limit-notice").classList.remove("hidden"):document.getElementById("pending-limit-notice").classList.add("hidden")},200)}function te(e){const o=document.getElementById("kycNotification"),n=document.getElementById("kycNotificationTitle"),t=document.getElementById("kycNotificationMessage"),s=document.getElementById("kycNotificationTime");if(!o||!n||!t||!s)return;const a=e.kycStatus||"not_completed";a==="pending"?(n.textContent="KYC Verification Pending",t.textContent="Your KYC document is currently under review. We will notify you once the verification is complete.",s.textContent="Recently",o.style.display="flex"):a==="reviewed"?(n.textContent="KYC Under Review",t.textContent="Your KYC document has been reviewed and is being processed. You will be notified once a decision is made.",s.textContent="Recently",o.style.display="flex"):a==="approved"||a==="completed"?(n.textContent="KYC Verification Approved",t.textContent="Congratulations! Your KYC verification has been approved. Your account now has full access to all features.",s.textContent="Recently",o.style.display="flex"):a==="rejected"||a==="declined"?(n.textContent="KYC Verification Rejected",t.textContent="Your KYC verification was not approved. Please upload a new valid government-issued ID document to complete verification.",s.textContent="Recently",o.style.display="flex"):(n.textContent="KYC Verification Required",t.textContent="Complete your KYC verification to unlock all account features. Upload a valid government-issued ID in the Security section.",s.textContent="Important",o.style.display="flex")}function ge(e){var l;const o=((l=B.currentUser)==null?void 0:l.uid)||null;if(o&&(e!=null&&e.__uid)&&e.__uid!==o)return;const n=d=>{if(!d)return"0.00";const c=typeof d=="string"?parseFloat(d.replace(/[^0-9.-]/g,""))||0:Number(d)||0;return new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(c)};document.getElementById("checking").textContent=n(e.checking),document.getElementById("savings").textContent=n(e.savings),document.getElementById("fixed").textContent=n(e.fixed),te(e),ye(e),xe(e);const t=document.getElementById("user-first-name");e.firstName&&e.firstName.trim()!==""&&(t.textContent=e.firstName);const s=document.getElementById("cardholder-name"),a=document.getElementById("modal-cardholder-name");let r="";e.firstName&&e.lastName?r=`${e.firstName.toUpperCase()} ${e.lastName.toUpperCase()}`:e.firstName&&(r=e.firstName.toUpperCase()),r&&(s&&(s.textContent=r),a&&(a.textContent=r))}function ye(e){let o=!1,n=0;for(let a=1;a<=20;a++){const r=document.getElementById(`history${a}`);if(r){const l=e[`history${a}`]||"";if(l&&l.trim()!==""){if(ee(r,l),n<10){r.style.display="block";const d=r.querySelector(".mobile-transaction-item");d&&(d.style.display="flex"),n++}else{r.style.display="none";const d=r.querySelector(".mobile-transaction-item");d&&(d.style.display="none")}a>10&&(o=!0)}else{r.style.display="none";const d=r.querySelector(".mobile-transaction-item");d&&(d.style.display="none")}}}const t=document.getElementById("see-more");t&&(o?t.classList.remove("hidden"):t.classList.add("hidden"));const s=document.getElementById("recent-transactions");s&&(s.removeEventListener("click",F),s.addEventListener("click",F,{passive:!0}))}function xe(e){const o=document.getElementById("pending1"),n=document.getElementById("pending2"),t=document.getElementById("pending3"),s=document.getElementById("pending4"),a=document.getElementById("pending5"),r=document.getElementById("pending-list");function l(d,c){const f=c.split("|").map(w=>w.trim()),g=f[0]||"",x=f[1]||"",u=f[2]||"";f[3];const i=f[4]||"";f[5];const h=d.querySelector(".pending-description"),E=d.querySelector(".pending-recipient"),C=d.querySelector(".pending-type"),y=d.querySelector(".pending-amount"),b=d.querySelector(".pending-date"),m=d.querySelector(".pending-avatar"),p=d.querySelector(".pending-avatar-text");h&&(h.textContent=g),E&&(E.textContent=x),C&&(C.textContent=g),y&&(y.textContent=u),b&&(b.textContent=i),m&&p&&(p.textContent="PN",m.className="w-12 h-12 rounded-full flex items-center justify-center pending-avatar font-semibold text-sm bg-orange-50 text-orange-700")}e.pending1&&e.pending1.trim()!==""&&(o.classList.remove("hidden"),l(o,e.pending1),r&&r.appendChild(o)),e.pending2&&e.pending2.trim()!==""&&(n.classList.remove("hidden"),l(n,e.pending2),r&&r.appendChild(n)),e.pending3&&e.pending3.trim()!==""&&(t.classList.remove("hidden"),l(t,e.pending3),r&&r.appendChild(t)),e.pending4&&e.pending4.trim()!==""&&(s.classList.remove("hidden"),l(s,e.pending4),r&&r.appendChild(s)),e.pending5&&e.pending5.trim()!==""&&(a.classList.remove("hidden"),l(a,e.pending5),r&&r.appendChild(a)),e.pending1&&e.pending2&&e.pending3&&e.pending4&&e.pending5&&e.pending1.trim()!==""&&e.pending2.trim()!==""&&e.pending3.trim()!==""&&e.pending4.trim()!==""&&e.pending5.trim()!==""?document.getElementById("pending-limit-notice").classList.remove("hidden"):document.getElementById("pending-limit-notice").classList.add("hidden")}window.signOut=function(){Y(),Z(B).then(()=>{alert("Signed out successfully!"),window.location.href="login.html"}).catch(e=>{alert("Error signing out: "+e.message)})};let _=null;async function Ce(e){try{const o=T(L,"loans",e.uid);_&&_(),_=K(o,n=>{if(n.exists()){const t=n.data();console.log("Loan document updated:",t),console.log("Loan status:",t.status),be(t)}else console.log("Loan document does not exist"),X()},n=>{console.warn("Error listening to loan status:",n),n.code!=="permission-denied"&&X()})}catch(o){console.error("Error checking loan status:",o)}}function be(e){const o=e.status||e.loanStatus||"pending",n=String(o).toLowerCase().trim();e.loanAmount,e.submittedAt||e.createdAt,console.log("Updating loan status display:",{rawStatus:o,normalizedStatus:n,fullLoanData:e});const t=document.getElementById("loanStatusCard"),s=document.getElementById("loanProgressModal");s&&s.classList.add("hidden"),t?(t.classList.remove("hidden"),he(e,n)):console.error("Loan status card not found")}function he(e,o){const n=document.getElementById("loanStatusCard");if(!n)return;const t=e.loanAmount||0,s=e.submittedAt||e.createdAt;let a="N/A";s&&s.toDate&&(a=s.toDate().toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}));const r=n.querySelector("#loanCardAmount"),l=n.querySelector("#loanCardStatus"),d=n.querySelector("#loanCardDate"),c=n.querySelector("#loanCardIcon"),f=n.querySelector("#loanCardTitle"),g=n.querySelector("#loanCardMessage");r&&(r.textContent=`$${t.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`),d&&(d.textContent=a),o==="approved"?(c&&(c.className="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",c.innerHTML='<i class="fas fa-check-circle text-blue-600 text-2xl"></i>'),f&&(f.textContent="Loan Approved"),g&&(g.textContent="Your loan application has been approved. View details to see repayment schedule."),l&&(l.textContent="Approved",l.className="px-3 py-1 rounded-full text-xs font-semibold bg-blue-100 text-blue-700"),n.className="bg-white rounded-xl shadow-lg border-2 border-blue-200 p-5 mb-6"):o==="rejected"?(c&&(c.className="w-12 h-12 bg-red-100 rounded-full flex items-center justify-center",c.innerHTML='<i class="fas fa-times-circle text-red-600 text-2xl"></i>'),f&&(f.textContent="Loan Rejected"),g&&(g.textContent="Your loan application was not approved. Contact support for more information."),l&&(l.textContent="Rejected",l.className="px-3 py-1 rounded-full text-xs font-semibold bg-red-100 text-red-700"),n.className="bg-white rounded-xl shadow-lg border-2 border-red-200 p-5 mb-6"):(c&&(c.className="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",c.innerHTML='<i class="fas fa-spinner fa-spin text-blue-600 text-2xl"></i>'),f&&(f.textContent="Loan Under Review"),g&&(g.textContent="Your loan application is being reviewed. We will notify you once a decision is made."),l&&(l.textContent="Pending",l.className="px-3 py-1 rounded-full text-xs font-semibold bg-yellow-100 text-yellow-700"),n.className="bg-white rounded-xl shadow-lg border-2 border-blue-200 p-5 mb-6"),n.dataset.loanData=JSON.stringify(e),n.dataset.loanStatus=o}function G(e,o){const n=document.getElementById("loanProgressModal"),t=document.getElementById("loanProgressIcon"),s=document.getElementById("loanProgressTitle"),a=document.getElementById("loanProgressMessage"),r=document.getElementById("loanProgressAmount"),l=document.getElementById("loanProgressStatus"),d=document.getElementById("loanProgressDate"),c=document.getElementById("loanProgressBar");if(!n){console.error("Loan progress modal not found");return}const f=String(o).toLowerCase().trim();console.log("Showing loan status modal with status:",f,"original:",o);const g=e.loanAmount||0,x=e.submittedAt||e.createdAt;let u="N/A";if(x&&x.toDate&&(u=x.toDate().toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})),r.textContent=`$${g.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`,d.textContent=u,f==="approved"){console.log("Setting modal to APPROVED state"),t.className="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",t.innerHTML='<i class="fas fa-check-circle text-blue-600 text-3xl"></i>',s.textContent="Loan Application Approved!",a.textContent="Congratulations! Your loan application has been approved. Click the button below to view your loan details and repayment schedule.",l.textContent="Approved",l.className="text-sm font-semibold text-blue-600",c.style.width="100%",c.className="bg-blue-600 h-2 rounded-full transition-all duration-500";const i=n.querySelector("button");i&&(i.innerHTML='<i class="fas fa-arrow-right mr-2"></i>View Loan Details',i.onclick=function(){window.location.href="loan.html"},i.className="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-lg transition-all duration-200")}else if(f==="rejected"){console.log("Setting modal to REJECTED state"),t.className="w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",t.innerHTML='<i class="fas fa-times-circle text-red-600 text-3xl"></i>',s.textContent="Loan Application Rejected",a.textContent="We're sorry, but your loan application has been rejected. Please contact support for more information or try applying again later.",l.textContent="Rejected",l.className="text-sm font-semibold text-red-600",c.style.width="100%",c.className="bg-red-600 h-2 rounded-full transition-all duration-500";const i=n.querySelector("button");i&&(i.innerHTML='<i class="fas fa-times mr-2"></i>Close',i.onclick=function(){closeLoanProgressModal()},i.className="w-full text-white font-semibold py-3 px-6 rounded-lg transition-all duration-200",i.style.backgroundColor="#1800ac",i.onmouseover=function(){this.style.backgroundColor="#140099"},i.onmouseout=function(){this.style.backgroundColor="#1800ac"})}else{console.log("Setting modal to PENDING state"),t.className="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",t.innerHTML='<i class="fas fa-spinner fa-spin text-blue-600 text-3xl"></i>',s.textContent="Loan Application Under Review",a.textContent="Your loan application is being reviewed by our team. You will be notified once a decision has been made.",l.textContent="Pending",l.className="text-sm font-semibold text-yellow-600",c.style.width="50%",c.className="bg-blue-600 h-2 rounded-full transition-all duration-500";const i=n.querySelector("button");i&&(i.innerHTML='<i class="fas fa-times mr-2"></i>Close',i.onclick=function(){closeLoanProgressModal()},i.className="w-full text-white font-semibold py-3 px-6 rounded-lg transition-all duration-200",i.style.backgroundColor="#1800ac",i.onmouseover=function(){this.style.backgroundColor="#140099"},i.onmouseout=function(){this.style.backgroundColor="#1800ac"})}n.classList.remove("hidden")}function X(){const e=document.getElementById("loanStatusBadge"),o=document.getElementById("loanProgressModal"),n=document.getElementById("loanStatusCard");e&&e.classList.add("hidden"),o&&o.classList.add("hidden"),n&&n.classList.add("hidden")}window.openLoanProgressModal=function(){const e=document.getElementById("loanStatusCard");if(e&&e.dataset.loanData)try{const o=JSON.parse(e.dataset.loanData),n=e.dataset.loanStatus||o.status||"pending";G(o,n)}catch(o){console.error("Error parsing loan data:",o)}else{const o=B.currentUser;if(!o)return;const n=T(L,"loans",o.uid);R(n).then(t=>{if(t.exists()){const s=t.data();G(s,s.status||"pending")}}).catch(t=>{console.error("Error loading loan data:",t)})}};window.closeLoanProgressModal=function(){const e=document.getElementById("loanProgressModal");e&&e.classList.add("hidden")};
