import"./modulepreload-polyfill-B5Qt9EMX.js";import{a as r,d as l}from"./firebase-client-DudADU2j.js";import{onAuthStateChanged as g,signOut as f,signInWithEmailAndPassword as y}from"https://www.gstatic.com/firebasejs/9.6.1/firebase-auth.js";import{doc as c,getDoc as p,setDoc as E}from"https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js";import"./firebase-config-CJaibweW.js";import"https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";g(r,async e=>{if(e){const o=c(l,"users",e.uid),t=await p(o);if(t.exists()){const n=t.data();document.getElementById("firstName").value=n.firstName||"",document.getElementById("firstName").placeholder=n.firstName||"First Name",document.getElementById("profileUsername").textContent=n.firstName||"@syndicate",document.getElementById("Deposit-account").textContent=n.deposit||"0.00",document.getElementById("Profit-wallet").textContent=n.profit||"0.00",document.getElementById("wallet").textContent=n.wallet||"0.00",document.getElementById("welcome-message").textContent=`Welcome ${n.firstName}`,document.getElementById("displayEmail").textContent=e.email}else console.log("No user document found."),alert("No user data found.")}else console.log("No user signed in. Redirecting to sign-in page."),window.location.href="login.html"});window.signOut=function(){f(r).then(()=>{alert("Signed out successfully!"),window.location.href="login.html"}).catch(e=>{alert("Error signing out: "+e.message)})};const w=document.getElementById("changePinForm");w.addEventListener("submit",e=>{e.preventDefault();const o=document.getElementById("newPin").value;if(o.length!==5||isNaN(o)){alert("Please enter a valid 5-digit PIN.");return}const t=document.getElementById("submitButton");t.disabled=!0,t.textContent="Processing...",setTimeout(()=>{document.getElementById("passwordModal").classList.remove("hidden"),t.disabled=!1,t.textContent="Change PIN"},1e3)});const i=document.getElementById("passwordConfirmForm");i.addEventListener("submit",async e=>{e.preventDefault();const o=document.getElementById("email").value,t=document.getElementById("firebasePassword").value,n=document.getElementById("newPin").value,s=i.querySelector('button[type="submit"]');s.disabled=!0,s.textContent="Processing...";try{const m=(await y(r,o,t)).user;if(m){const u=c(l,"users",m.uid);await E(u,{pin:n},{merge:!0});const d=document.createElement("div");d.textContent="PIN Change updated!",d.className="text-blue-700 text-xs text-center mt-4",i.parentElement.appendChild(d),setTimeout(()=>{document.getElementById("passwordModal").classList.add("hidden")},2e3)}}catch(a){console.error("Error updating PIN:",a),alert("Error updating PIN: "+a.message)}finally{s.disabled=!1,s.textContent="Confirm"}});
