import"./modulepreload-polyfill-B5Qt9EMX.js";import{initializeApp as K}from"https://www.gstatic.com/firebasejs/9.1.3/firebase-app.js";import{getAuth as O,onAuthStateChanged as Z,signOut as U}from"https://www.gstatic.com/firebasejs/9.1.3/firebase-auth.js";import{getFirestore as _,updateDoc as W,getDoc as Y,doc as z,serverTimestamp as ee,collection as S,addDoc as te,query as A,where as P,getDocs as j}from"https://www.gstatic.com/firebasejs/9.1.3/firebase-firestore.js";const ne={apiKey:"AIzaSyABYV12B7RM2ZCD2G1lFTLpgJwflJFwEXY",authDomain:"beal-offshore.firebaseapp.com",projectId:"beal-offshore",storageBucket:"beal-offshore.firebasestorage.app",messagingSenderId:"1091834410162",appId:"1:1091834410162:web:56285433b5751e681745ab",measurementId:"G-CT463F3T6J"},J=K(ne),N=O(J),L=_(J);window.auth=N;window.db=L;window.firestoreHelpers={addDoc:te,collection:S,serverTimestamp:ee,doc:z,getDoc:Y,updateDoc:W};let k;const oe=2e5;function h(){clearTimeout(k),k=setTimeout(()=>{const n=O();U(n).then(()=>{window.location.href="login.html"}).catch(y=>{console.error("Error signing out:",y),window.location.href="login.html"})},oe)}document.addEventListener("mousemove",h);document.addEventListener("keypress",h);document.addEventListener("click",h);document.addEventListener("scroll",h);document.addEventListener("touchstart",h);h();function ie(n,y){const a=y.split("|").map(s=>s.trim()),t=a[0]||"",T=a[1]||"",I=a[2]||"";a[3];const l=a[4]||"",x=a[5]||"";a.slice(6).join("|");const p=n.querySelector(".transaction-description"),g=n.querySelector(".transaction-recipient"),E=n.querySelector(".transaction-type"),m=n.querySelector(".transaction-amount"),u=n.querySelector(".transaction-date"),v=n.querySelector(".transaction-reference"),w=n.querySelector(".meta-row"),C=n.querySelector(".separator"),b=n.querySelector(".transaction-avatar"),f=n.querySelector(".transaction-avatar-text");if(p&&(p.textContent=t),g&&(g.textContent=T),E&&(E.textContent=t),m&&(m.textContent=I),u&&(u.textContent=l),v&&(v.textContent=x),w){const s=!!t&&t!=="-",r=!!l&&l!=="-";s||r?(w.classList.remove("hidden"),C&&(s&&r?C.classList.remove("hidden"):C.classList.add("hidden"))):w.classList.add("hidden")}if(b&&f){const s=(t||"").toLowerCase();let r="TX",c="bg-blue-50",d="text-blue-700";s.includes("deposit")?(r="DP",c="bg-green-50",d="text-green-700"):s.includes("transfer")?(r="TF",c="bg-indigo-50",d="text-indigo-700"):s.includes("refund")?(r="RF",c="bg-amber-50",d="text-amber-700"):s.includes("reversal")&&(r="RV",c="bg-rose-50",d="text-rose-700"),f.textContent=r,b.className="w-12 h-12 rounded-full flex items-center justify-center transaction-avatar font-semibold text-sm "+c+" "+d}}Z(N,async n=>{if(n){console.log("User is logged in:",n.uid);const y=z(L,"users",n.uid),a=await Y(y);if(a.exists()){let m=function(e,i){const o=i.split("|").map(X=>X.trim()),D=o[0]||"",G=o[1]||"",Q=o[2]||"";o[3];const V=o[4]||"";o[5];const q=e.querySelector(".pending-description"),B=e.querySelector(".pending-recipient"),$=e.querySelector(".pending-type"),M=e.querySelector(".pending-amount"),H=e.querySelector(".pending-date"),R=e.querySelector(".pending-avatar"),F=e.querySelector(".pending-avatar-text");q&&(q.textContent=D),B&&(B.textContent=G),$&&($.textContent=D),M&&(M.textContent=Q),H&&(H.textContent=V),R&&F&&(F.textContent="PN",R.className="w-12 h-12 rounded-full flex items-center justify-center pending-avatar font-semibold text-sm bg-orange-50 text-orange-700")},u=function(e){!E||!e||E.appendChild(e)};const t=a.data();document.getElementById("Deposit-account").textContent=`${t.deposit||"$0.00"}`;let T=!1,I=0;for(let e=1;e<=20;e++){const i=document.getElementById(`history${e}`);if(i){const o=t[`history${e}`]||"";o&&o.trim()!==""?(ie(i,o),I<10?(i.style.display="block",I++):i.style.display="none",e>10&&(T=!0)):i.style.display="none"}}const l=document.getElementById("see-more");l&&(T?l.classList.remove("hidden"):l.classList.add("hidden")),document.getElementById("savings").textContent=`${t.savings||"$0.00"}`,document.getElementById("fixed").textContent=`${t.fixed||"$0.00"}`;const x=document.getElementById("pending1"),p=document.getElementById("pending2"),g=document.getElementById("pending3"),E=document.getElementById("pending-list");t.pending1&&t.pending1.trim()!==""&&(x.classList.remove("hidden"),m(x,t.pending1),u(x)),t.pending2&&t.pending2.trim()!==""&&(p.classList.remove("hidden"),m(p,t.pending2),u(p)),t.pending3&&t.pending3.trim()!==""&&(g.classList.remove("hidden"),m(g,t.pending3),u(g)),t.pending1&&t.pending2&&t.pending3&&t.pending1.trim()!==""&&t.pending2.trim()!==""&&t.pending3.trim()!==""?document.getElementById("pending-limit-notice").classList.remove("hidden"):document.getElementById("pending-limit-notice").classList.add("hidden"),setTimeout(colorPendingTransactions,500);const v=document.getElementById("user-first-name");t.firstName&&t.name.trim()!==""?v.textContent=t.firstName:(v.textContent="",console.log("User data does not contain a valid name field."));const w=S(L,"history"),C=A(w,P("userId","==",n.uid)),b=await j(C),f=document.getElementById("history-container");if(f.innerHTML="",!b.empty)b.forEach(e=>{const i=e.data(),o=document.createElement("div");o.className="bg-white p-4 rounded-lg shadow-md text-center h-16",o.innerHTML=`
                                <h3 class="font-semibold text-gray-800">${i.description||"No description"}</h3>
                                <p class="text-gray-600">ID: ${e.id}</p>
                                <p class="text-gray-600">$${i.amount||""}</p>
                            `,f.appendChild(o)});else{console.log("No transaction history found for this user.");const e=document.createElement("div");e.className="bg-white p-4 rounded-lg shadow-md text-center h-16",e.innerHTML=`
                            <h3 class="font-semibold text-gray-800">No history</h3>
                            <p class="text-gray-600">You have no transaction history.</p>
                        `,f.appendChild(e)}const s=S(L,"pending"),r=A(s,P("userId","==",n.uid)),c=await j(r),d=document.getElementById("pending-container");if(d.innerHTML="",!c.empty)c.forEach(e=>{const i=e.data(),o=document.createElement("div");o.className="bg-white p-4 rounded-lg shadow-md text-center h-16",o.innerHTML=`
                                <h3 class="font-semibold text-gray-800">${i.description||"No description"}</h3>
                                <p class="text-gray-600">ID: ${e.id}</p>
                                <p class="text-gray-600">$${i.amount||""}</p>
                            `,d.appendChild(o)});else{console.log("No pending transactions found for this user.");const e=document.createElement("div");e.className="bg-white p-4 rounded-lg shadow-md text-center h-16",e.innerHTML=`
                            <h3 class="font-semibold text-gray-800">No pending transactions</h3>
                            <p class="text-gray-600">You have no pending transactions.</p>
                        `,d.appendChild(e)}}else console.log("No user document found in Firestore."),alert("No user data found.")}else console.log("No user signed in, redirecting to sign-in page."),window.location.href="login..html"});window.signOut=function(){U(N).then(()=>{alert("Signed out successfully!"),window.location.href="login.html"}).catch(n=>{alert("Error signing out: "+n.message)})};
