import"./modulepreload-polyfill-B5Qt9EMX.js";import"./index.esm-DdmE1zD_.js";import"https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";import{signInWithEmailAndPassword as c}from"https://www.gstatic.com/firebasejs/9.6.1/firebase-auth.js";import{initializeApp as g}from"https://www.gstatic.com/firebasejs/9.1.3/firebase-app.js";import{getAuth as u,signInWithEmailAndPassword as p}from"https://www.gstatic.com/firebasejs/9.1.3/firebase-auth.js";const f=(t,e)=>{const o=document.getElementById("login-btn");o.disabled=!0,o.textContent="Logging in...",c(auth,t,e).then(r=>{const n=r.user;console.log("User logged in:",n),window.location.href="otp.html"}).catch(r=>{const n=r.code,l=r.message;console.error("Error during login:",n,l),o.disabled=!1,o.textContent="Log In",alert("Invalid email or password. Please try again.")})};document.querySelector("form").addEventListener("submit",t=>{t.preventDefault();const e=document.getElementById("email").value,o=document.getElementById("password").value;f(e,o)});const y={apiKey:"AIzaSyABYV12B7RM2ZCD2G1lFTLpgJwflJFwEXY",authDomain:"beal-offshore.firebaseapp.com",projectId:"beal-offshore",storageBucket:"beal-offshore.firebasestorage.app",messagingSenderId:"1091834410162",appId:"1:1091834410162:web:56285433b5751e681745ab",measurementId:"G-CT463F3T6J"},w=g(y),h=u(w);emailjs.init("PpoJ-7X-bqUjp3Wa7");const I=document.getElementById("login-section"),E=document.getElementById("otp-section"),b=document.getElementById("login-form"),v=document.getElementById("otp-form"),s=document.getElementById("login-btn"),a=document.getElementById("resend-otp"),B=document.getElementById("email-display");let i=null;function d(t=6){return Array.from({length:t},()=>Math.floor(Math.random()*10)).join("")}async function m(t,e){try{return await emailjs.send("service_dou8hz3","template_nncgc6k",{to_email:t,email:t,otp:e}),!0}catch(o){return console.error("Error sending OTP:",o),!1}}b.addEventListener("submit",async t=>{t.preventDefault();const e=document.getElementById("email").value.trim(),o=document.getElementById("password").value;try{s.disabled=!0,s.textContent="Authenticating...",i=(await p(h,e,o)).user;const n=d();if(sessionStorage.setItem("loginOtp",n),!await m(e,n))throw new Error("Failed to send OTP");B.textContent=e,I.classList.add("hidden"),E.classList.remove("hidden")}catch(r){console.error("Login error:",r);let n="An error occurred during login.";r.code==="auth/user-not-found"||r.code==="auth/wrong-password"?n="Invalid email or password.":r.code==="auth/too-many-requests"&&(n="Too many failed attempts. Please try again later."),alert(n)}finally{s.disabled=!1,s.textContent="Log in"}});v.addEventListener("submit",async t=>{t.preventDefault();const e=document.getElementById("verify-otp-btn"),o=document.getElementById("otp").value,r=sessionStorage.getItem("loginOtp");e.disabled=!0,e.textContent="Logging in...";try{if(!r)throw new Error("OTP session expired");if(o===r)sessionStorage.removeItem("loginOtp"),await new Promise(n=>setTimeout(n,1e3)),window.location.href="dashboard.html";else throw new Error("Invalid OTP")}catch(n){alert(n.message+". Please try again."),e.disabled=!1,e.textContent="Proceed"}});a.addEventListener("click",async t=>{if(t.preventDefault(),!i){alert("Session expired. Please login again."),window.location.reload();return}a.textContent="Sending...";const e=d();await m(i.email,e)?(sessionStorage.setItem("loginOtp",e),alert("New OTP has been sent to your email.")):alert("Failed to send new OTP. Please try again."),a.textContent="Request again"});sessionStorage.removeItem("loginOtp");
