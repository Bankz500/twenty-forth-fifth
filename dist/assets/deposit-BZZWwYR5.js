import"./modulepreload-polyfill-B5Qt9EMX.js";class g{constructor(){this.initializeFirebase()}initializeFirebase(){if(typeof firebase<"u"){this.setupFirebase();return}const e=document.createElement("script");e.src="https://www.gstatic.com/firebasejs/11.1.0/firebase-app.js",e.onload=()=>{const t=document.createElement("script");t.src="https://www.gstatic.com/firebasejs/11.1.0/firebase-auth.js",t.onload=()=>{const n=document.createElement("script");n.src="https://www.gstatic.com/firebasejs/11.1.0/firebase-firestore.js",n.onload=()=>{this.setupFirebase()},n.onerror=o=>{console.error("Error loading Firebase Firestore:",o),this.handleFirebaseError()},document.head.appendChild(n)},t.onerror=n=>{console.error("Error loading Firebase Auth:",n),this.handleFirebaseError()},document.head.appendChild(t)},e.onerror=t=>{console.error("Error loading Firebase App:",t),this.handleFirebaseError()},document.head.appendChild(e)}setupFirebase(){try{const e={apiKey:"AIzaSyDyZiL4-h5n9Kqr24e7liROgHXMZau2ZmI",authDomain:"artis-stanbic-holdings.firebaseapp.com",projectId:"artis-stanbic-holdings",storageBucket:"artis-stanbic-holdings.firebasestorage.app",messagingSenderId:"124094969669",appId:"1:124094969669:web:54e6306dc5747a80ec8d8c",measurementId:"G-0WSC5YMY2C"};firebase.apps.length?this.app=firebase.app():this.app=firebase.initializeApp(e),this.auth=firebase.auth(),this.db=firebase.firestore(),console.log("Firebase initialized successfully for banking details"),this.auth.onAuthStateChanged(t=>{t?console.log("User authenticated:",t.uid):console.log("No user authenticated")})}catch(e){console.error("Error setting up Firebase:",e),this.handleFirebaseError()}}handleFirebaseError(){console.log("Firebase not available, using fallback mode"),this.app=null,this.auth=null,this.db=null}generateAccountNumber(){let e="";for(let t=0;t<10;t++)e+=Math.floor(Math.random()*10);return e}generateSwiftCode(){const e=["FTBC","CHAS","WELL","CITI","JPMO","BANK","AMEX"],t=["US","UK","CA","AU","SG"],n=["NYC","LON","TOR","SYD","SIN"],o=e[Math.floor(Math.random()*e.length)],c=n[Math.floor(Math.random()*n.length)],d=t[Math.floor(Math.random()*t.length)];return o+c+d}generateRoutingNumber(){let e="";for(let t=0;t<9;t++)e+=Math.floor(Math.random()*10);return e}generateBankingDetails(){return{accountNumber:this.generateAccountNumber(),swiftCode:this.generateSwiftCode(),routingNumber:this.generateRoutingNumber(),bankName:"Beal Offshore Ltd",accountType:"Personal Account",generatedAt:new Date().toISOString()}}async saveBankingDetails(e,t){try{if(!this.db)return console.log("Firebase not available, using localStorage fallback"),this.saveToLocalStorage(t);const n=this.db.collection("users").doc(e);return await this.db.collection("bankingDetails").doc(e).set({...t,userId:e,createdAt:new Date().toISOString(),isActive:!0}),await n.set({hasBankingDetails:!0,bankingDetailsId:e,lastUpdated:new Date().toISOString()},{merge:!0}),console.log("Banking details saved successfully to Firebase"),!0}catch(n){return console.error("Error saving banking details to Firebase:",n),console.log("Falling back to localStorage"),this.saveToLocalStorage(t)}}saveToLocalStorage(e){try{const t=`beal_banking_details_${Date.now()}`;return localStorage.setItem(t,JSON.stringify(e)),console.log("Banking details saved to localStorage as fallback"),!0}catch(t){return console.error("Error saving to localStorage:",t),!1}}async getBankingDetails(e){try{if(!this.db)return console.log("Firebase not available, using localStorage fallback"),this.getFromLocalStorage();const n=await this.db.collection("bankingDetails").doc(e).get();if(n.exists)return n.data();{const o=this.generateBankingDetails();return await this.saveBankingDetails(e,o),o}}catch(t){return console.error("Error getting banking details from Firebase:",t),console.log("Falling back to localStorage"),this.getFromLocalStorage()}}getFromLocalStorage(){try{for(let t=0;t<localStorage.length;t++){const n=localStorage.key(t);if(n&&n.startsWith("beal_banking_details_")){const o=JSON.parse(localStorage.getItem(n));if(o&&o.accountNumber)return o}}const e=this.generateBankingDetails();return this.saveToLocalStorage(e),e}catch(e){return console.error("Error getting from localStorage:",e),this.generateBankingDetails()}}getCurrentUserId(){if(this.auth&&this.auth.currentUser)return this.auth.currentUser.uid;let e=localStorage.getItem("beal_temp_user_id");return e||(e="temp_user_"+Date.now()+"_"+Math.random().toString(36).substr(2,9),localStorage.setItem("beal_temp_user_id",e)),e}async initializeUserBankingDetails(){const e=this.getCurrentUserId();console.log("Initializing banking details for user:",e);try{return await this.getBankingDetails(e)}catch(t){return console.error("Error initializing banking details:",t),null}}}const r=new g;function u(a){const e=document.getElementById(a).innerText;navigator.clipboard.writeText(e).then(()=>{alert("Copied to clipboard!")}).catch(t=>{console.error("Failed to copy: ",t)})}function b(a,e){const t=document.getElementById(a),n=document.getElementById(e);t.type==="password"?(t.type="text",n.setAttribute("stroke","green")):(t.type="password",n.setAttribute("stroke","black"))}function l(a){document.getElementById("account-number-loading").classList.add("hidden"),document.getElementById("swift-code-loading").classList.add("hidden"),document.getElementById("routing-number-loading").classList.add("hidden");const e=document.getElementById("account-number"),t=document.getElementById("swift-code"),n=document.getElementById("routing-number");e.textContent=a.accountNumber,t.textContent=a.swiftCode,n.textContent=a.routingNumber,e.classList.remove("hidden"),t.classList.remove("hidden"),n.classList.remove("hidden"),document.querySelectorAll(".copy-btn").forEach(o=>{o.disabled=!1,o.classList.remove("opacity-50")})}function i(){document.getElementById("account-number-loading").classList.add("hidden"),document.getElementById("swift-code-loading").classList.add("hidden"),document.getElementById("routing-number-loading").classList.add("hidden");const a=document.getElementById("account-number"),e=document.getElementById("swift-code"),t=document.getElementById("routing-number");a.textContent="Error loading details",e.textContent="Error loading details",t.textContent="Error loading details",a.classList.remove("hidden"),e.classList.remove("hidden"),t.classList.remove("hidden"),document.querySelectorAll(".copy-btn").forEach(n=>{n.disabled=!0,n.classList.add("opacity-50")}),setTimeout(()=>{try{const n=r.generateBankingDetails();n&&(console.log("Using fallback banking details:",n),l(n),s("Using fallback banking details","info"))}catch(n){console.error("Fallback also failed:",n)}},2e3)}document.addEventListener("DOMContentLoaded",async()=>{try{setTimeout(async()=>{const e=await r.initializeUserBankingDetails();e?(l(e),console.log("Banking details loaded successfully:",e)):(console.log("No banking details returned, showing error state"),i())},1500)}catch(e){console.error("Error initializing banking details:",e),i()}const a=document.getElementById("refresh-banking-details");a&&a.addEventListener("click",async()=>{try{m();const e=r.generateBankingDetails(),t=r.getCurrentUserId();t?(await r.saveBankingDetails(t,e),l(e),s("New banking details generated successfully!","success")):(i(),s("Please log in to generate new banking details","error"))}catch(e){console.error("Error generating new banking details:",e),i(),s("Failed to generate new banking details","error")}})});function m(){document.getElementById("account-number-loading").classList.remove("hidden"),document.getElementById("swift-code-loading").classList.remove("hidden"),document.getElementById("routing-number-loading").classList.remove("hidden"),document.getElementById("account-number").classList.add("hidden"),document.getElementById("swift-code").classList.add("hidden"),document.getElementById("routing-number").classList.add("hidden"),document.querySelectorAll(".copy-btn").forEach(a=>{a.disabled=!0,a.classList.add("opacity-50")})}function s(a,e="info"){const t=document.createElement("div");t.className=`fixed top-20 right-4 p-4 rounded-lg shadow-lg z-50 transition-all duration-300 ${e==="success"?"bg-green-500 text-white":e==="error"?"bg-red-500 text-white":"bg-blue-500 text-white"}`,t.textContent=a,document.body.appendChild(t),setTimeout(()=>{t.remove()},3e3)}window.copyToClipboard=u;window.toggleVisibility=b;
