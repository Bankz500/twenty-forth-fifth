import"./modulepreload-polyfill-B5Qt9EMX.js";import{a as L,d as B,f as ie,s as Q,u as se,b as R,e as T,h as F,c as ae,i as le,j as de,k as Y,o as re,l as Z,m as ce,n as K}from"./firebase-client-B2F1CqW_.js";import"./firebase-config-C56FTJjz.js";window.auth=L;window.db=B;window.firestoreHelpers={addDoc:le,collection:ae,serverTimestamp:F,doc:T,getDoc:R,updateDoc:se,setDoc:Q,deleteDoc:ie};function me(e){try{let o=document.getElementById("firebaseStatusBanner");o||(o=document.createElement("div"),o.id="firebaseStatusBanner",o.className="fixed top-0 left-0 right-0 z-50 bg-red-600 text-white text-sm px-4 py-3 shadow-lg",document.body.appendChild(o)),o.textContent=e}catch{}}window.addEventListener("unhandledrejection",e=>{var n;const o=((n=e==null?void 0:e.reason)==null?void 0:n.message)||String((e==null?void 0:e.reason)||"");(o.includes("auth/internal-error")||o.includes("Could not reach Cloud Firestore backend"))&&me("Connection issue: Firebase could not be reached (offline/VPN/adblock). Please check your internet connection and try again.")});document.addEventListener("DOMContentLoaded",()=>{var e;try{const o=de(),n=document.getElementById("user-first-name"),t=((e=L.currentUser)==null?void 0:e.uid)||null;if(!o||!n||n.textContent.trim()||!t)return;if(o.__uid&&o.__uid!==t){Y();return}o.__uid===t&&ge(o)}catch{}},{passive:!0});let A=null,P=null,k=null,q=null;function U(){const e=document.getElementById("debitCardProgressWrap"),o=document.getElementById("debitCardProgressStatus"),n=document.getElementById("debitCardProgressBar"),t=document.getElementById("debitCardProgressText");if(!e||!o||!n||!t)return;const s=k&&(k.status||"active")==="active",a=((q==null?void 0:q.status)||"").toLowerCase();if(s){e.classList.add("hidden");return}if(a==="pending"){e.classList.remove("hidden"),o.textContent="Pending approval",n.style.width="60%",t.textContent="Your debit card request is being reviewed.";return}e.classList.add("hidden")}function ue(e){try{if(A){try{A()}catch{}A=null}if(P){try{P()}catch{}P=null}k=null,q=null;const o=T(B,"debit_cards",e.uid),n=T(B,"debit_card_applications",e.uid);A=K(o,t=>{k=t.exists()?t.data():null,U()},()=>{k=null,U()}),P=K(n,t=>{q=t.exists()?t.data():null,U()},()=>{q=null,U()})}catch(o){console.warn("Debit card progress setup failed",o)}}function ee(e,o){const n=o.split("|").map(u=>u.trim()),t=n[0]||"",s=n[1]||"",a=n[2]||"",l=n[3]||"",d=n[4]||"",r=n[5]||"",c=n.slice(6).join("|")||"";e.dataset.transactionType=t,e.dataset.transactionRecipient=s,e.dataset.transactionAmount=a,e.dataset.transactionTime=l,e.dataset.transactionDate=d,e.dataset.transactionReference=r,e.dataset.transactionNotes=c;const p=e.querySelector(".transaction-description"),f=e.querySelector(".transaction-recipient"),y=e.querySelector(".transaction-type"),x=e.querySelector(".transaction-amount"),i=e.querySelector(".transaction-date"),h=e.querySelector(".transaction-reference"),E=e.querySelector(".meta-row"),C=e.querySelector(".separator"),g=e.querySelector(".transaction-avatar"),b=e.querySelector(".transaction-avatar-text");p&&(p.textContent=t),f&&(f.textContent=s),y&&(y.textContent=t),x&&(x.textContent=a),i&&(i.textContent=d),h&&(h.textContent=r);const m=e.querySelector(".mobile-transaction-item");if(m){const u=m.querySelector(".mobile-transaction-description"),S=m.querySelector(".mobile-transaction-time"),v=m.querySelector(".mobile-transaction-amount"),w=m.querySelector(".mobile-transaction-icon"),I=m.querySelector(".transaction-icon-text-mobile");if(u&&(u.textContent=t||s||"Transaction"),S&&(S.textContent=l||d||"-"),v){v.textContent=a||"-";const N=a&&(a.startsWith("+")||a.includes("credit")||a.includes("deposit"));v.className="mobile-transaction-amount transaction-amount-mobile "+(N?"credit":"debit")}if(w&&I){const N=(t||"").toLowerCase();N.includes("cashback")||N.includes("refund")?(w.style.backgroundColor="#e0f2fe",I.textContent="₦",I.style.color="#0369a1"):N.includes("mtn")||N.includes("data")?(w.style.backgroundColor="#fef3c7",I.textContent="MTN",I.style.fontSize="10px",I.style.color="#1e40af"):N.includes("savings")||N.includes("deposit")?(w.style.backgroundColor="#ede9fe",I.textContent="K.",I.style.fontSize="12px",I.style.color="#7c3aed"):(w.style.backgroundColor="#e0f2fe",I.textContent="₦",I.style.color="#0369a1")}}if(E){const u=!!t&&t!=="-",S=!!d&&d!=="-";u||S?(E.classList.remove("hidden"),C&&(u&&S?C.classList.remove("hidden"):C.classList.add("hidden"))):E.classList.add("hidden")}if(g&&b){const u=(t||"").toLowerCase();let S="TX",v="bg-blue-50",w="text-blue-700";u.includes("deposit")?(S="DP",v="bg-blue-50",w="text-blue-700"):u.includes("transfer")?(S="TF",v="bg-indigo-50",w="text-indigo-700"):u.includes("refund")?(S="RF",v="bg-amber-50",w="text-amber-700"):u.includes("reversal")&&(S="RV",v="bg-rose-50",w="text-rose-700"),b.textContent=S,g.className="w-12 h-12 rounded-full flex items-center justify-center transaction-avatar font-semibold text-sm "+v+" "+w}}function pe(e){const o=document.getElementById("transactionDetailModal");if(!o||!e)return;const n=e.dataset.transactionType||"",t=e.dataset.transactionRecipient||"",s=e.dataset.transactionAmount||"",a=e.dataset.transactionTime||"",l=e.dataset.transactionDate||"",d=e.dataset.transactionReference||"",r=e.dataset.transactionNotes||"";let c=l;l&&a?c=`On ${l} at ${a}`:l?c=l:a&&(c=a);const p=s&&(s.startsWith("+")||s.includes("credit")||s.includes("deposit"));document.getElementById("detail-amount").textContent=s||"₦0.00",document.getElementById("detail-amount").className="transaction-detail-amount"+(p?" credit":""),document.getElementById("detail-type").textContent=(n||t||"Transaction").toUpperCase(),document.getElementById("detail-date").textContent=c||"-",document.getElementById("detail-description").textContent=r||n||t||"-",document.getElementById("detail-method").textContent=n||"-",document.getElementById("detail-reference").textContent=d||"-",document.getElementById("detail-from").textContent=t||"Kuda";const f=(n||"").toLowerCase();let y="Savings";f.includes("cashback")?y="Cashback":f.includes("mtn")||f.includes("data")?y="Data":f.includes("savings")&&(y="Savings"),document.getElementById("detail-category").textContent=y,window.innerWidth<768&&(o.classList.add("active"),document.body.style.overflow="hidden")}function $(e){if(window.innerWidth>=768)return;const o=e.target.closest(".mobile-transaction-item");if(!o)return;const n=o.dataset.transactionId;if(!n)return;const t=document.getElementById(n);t&&t.dataset.transactionType&&t.dataset.transactionType!==""&&(e.preventDefault(),e.stopPropagation(),pe(t))}let j=!1,M=null;re(L,async e=>{if(M&&(clearTimeout(M),M=null),e){j=!0,console.log("User is logged in:",e.uid);const o=document.querySelectorAll(".accounts-section, #history-container");o.forEach(n=>{n&&(n.style.opacity="0.6")}),await fe(e),Ce(e),ue(e),o.forEach(n=>{n&&(n.style.opacity="1")})}else j||(await new Promise(o=>setTimeout(o,500)),j=!0),M=setTimeout(()=>{L.currentUser||(console.log("No user signed in. Redirecting to sign-in page."),Y(),window.location.href="login.html")},1e3)});async function fe(e){const o=T(B,"users",e.uid),n=await R(o);let t=null;if(n.exists())t=n.data()||{};else{let x=null;try{const g=(e.email||"").trim();if(g){const b=T(B,"users",g),m=await R(b);m.exists()&&(x=m.data()||{})}}catch(g){console.warn("Legacy email-doc migration skipped/failed:",g)}const i=x&&typeof x=="object"?x:{},h=e.displayName||"",E=i.firstName||(typeof i.name=="string"?i.name.split(" ")[0]:"")||(typeof i.fullName=="string"?i.fullName.split(" ")[0]:"")||(h?h.split(" ")[0]:"")||(e.email||"").split("@")[0]||"",C={...i,email:i.email||e.email||null,firstName:i.firstName||E||null,approvalStatus:i.approvalStatus||"approved",isApproved:typeof i.isApproved=="boolean"?i.isApproved:!0,approvedAt:i.approvedAt||F(),approvedBy:i.approvedBy||(x?"legacy_migrated":"legacy_auto"),createdAt:i.createdAt||F(),createdAtIso:i.createdAtIso||new Date().toISOString(),migratedFrom:x?"users/{email}":null};await Q(o,C,{merge:!0}),t=C}const s=(t==null?void 0:t.approvalStatus)||null,a=typeof(t==null?void 0:t.isApproved)=="boolean"?t.isApproved:null;if(!(s==="approved"||s==null&&a!==!1)){Y();try{await Z(L)}catch{}window.location.href="login.html?pending=1";return}ce({...t||{},__uid:e.uid,__email:e.email||(t==null?void 0:t.email)||null});const d=t.deposit??t.checking??"$0.00";document.getElementById("Deposit-account").textContent=`${d||"$0.00"}`,document.getElementById("savings").textContent=`${t.savings||"$0.00"}`,document.getElementById("fixed").textContent=`${t.fixed||"$0.00"}`,te(t);const r=document.getElementById("user-first-name"),c=typeof t.firstName=="string"&&t.firstName.trim()?t.firstName.trim():typeof t.name=="string"&&t.name.trim()?t.name.trim().split(" ")[0]:typeof t.fullName=="string"&&t.fullName.trim()?t.fullName.trim().split(" ")[0]:e.email?e.email.split("@")[0]:"";r&&(r.textContent=c||"");const p=document.getElementById("cardholder-name"),f=document.getElementById("modal-cardholder-name");let y="";t.firstName&&t.lastName?y=`${String(t.firstName).toUpperCase()} ${String(t.lastName).toUpperCase()}`:t.firstName?y=String(t.firstName).toUpperCase():t.fullName?y=String(t.fullName).toUpperCase():t.name&&(y=String(t.name).toUpperCase()),y&&(p&&(p.textContent=y),f&&(f.textContent=y)),setTimeout(()=>{let x=!1,i=0;for(let C=1;C<=20;C++){const g=document.getElementById(`history${C}`);if(g){const b=t[`history${C}`]||"";if(b&&b.trim()!==""){if(ee(g,b),i<10){g.style.display="block";const m=g.querySelector(".mobile-transaction-item");m&&(m.style.display="flex"),i++}else{g.style.display="none";const m=g.querySelector(".mobile-transaction-item");m&&(m.style.display="none")}C>10&&(x=!0)}else{g.style.display="none";const m=g.querySelector(".mobile-transaction-item");m&&(m.style.display="none")}}}const h=document.getElementById("see-more");h&&(x?h.classList.remove("hidden"):h.classList.add("hidden"));const E=document.getElementById("recent-transactions");E&&(E.removeEventListener("click",$),E.addEventListener("click",$,{passive:!0}))},100),setTimeout(()=>{const x=document.getElementById("pending1"),i=document.getElementById("pending2"),h=document.getElementById("pending3"),E=document.getElementById("pending4"),C=document.getElementById("pending5"),g=document.getElementById("pending-list");function b(u,S){const v=S.split("|").map(oe=>oe.trim()),w=v[0]||"",I=v[1]||"",N=v[2]||"";v[3];const ne=v[4]||"";v[5];const H=u.querySelector(".pending-description"),V=u.querySelector(".pending-recipient"),z=u.querySelector(".pending-type"),O=u.querySelector(".pending-amount"),W=u.querySelector(".pending-date"),J=u.querySelector(".pending-avatar"),G=u.querySelector(".pending-avatar-text");H&&(H.textContent=w),V&&(V.textContent=I),z&&(z.textContent=w),O&&(O.textContent=N),W&&(W.textContent=ne),J&&G&&(G.textContent="PN",J.className="w-12 h-12 rounded-full flex items-center justify-center pending-avatar font-semibold text-sm bg-orange-50 text-orange-700")}function m(u){!g||!u||g.appendChild(u)}t.pending1&&t.pending1.trim()!==""&&(x.classList.remove("hidden"),b(x,t.pending1),m(x)),t.pending2&&t.pending2.trim()!==""&&(i.classList.remove("hidden"),b(i,t.pending2),m(i)),t.pending3&&t.pending3.trim()!==""&&(h.classList.remove("hidden"),b(h,t.pending3),m(h)),t.pending4&&t.pending4.trim()!==""&&(E.classList.remove("hidden"),b(E,t.pending4),m(E)),t.pending5&&t.pending5.trim()!==""&&(C.classList.remove("hidden"),b(C,t.pending5),m(C)),t.pending1&&t.pending2&&t.pending3&&t.pending4&&t.pending5&&t.pending1.trim()!==""&&t.pending2.trim()!==""&&t.pending3.trim()!==""&&t.pending4.trim()!==""&&t.pending5.trim()!==""?document.getElementById("pending-limit-notice").classList.remove("hidden"):document.getElementById("pending-limit-notice").classList.add("hidden")},200)}function te(e){const o=document.getElementById("kycNotification"),n=document.getElementById("kycNotificationTitle"),t=document.getElementById("kycNotificationMessage"),s=document.getElementById("kycNotificationTime");if(!o||!n||!t||!s)return;const a=e.kycStatus||"not_completed";a==="pending"?(n.textContent="KYC Verification Pending",t.textContent="Your KYC document is currently under review. We will notify you once the verification is complete.",s.textContent="Recently",o.style.display="flex"):a==="reviewed"?(n.textContent="KYC Under Review",t.textContent="Your KYC document has been reviewed and is being processed. You will be notified once a decision is made.",s.textContent="Recently",o.style.display="flex"):a==="approved"||a==="completed"?(n.textContent="KYC Verification Approved",t.textContent="Congratulations! Your KYC verification has been approved. Your account now has full access to all features.",s.textContent="Recently",o.style.display="flex"):a==="rejected"||a==="declined"?(n.textContent="KYC Verification Rejected",t.textContent="Your KYC verification was not approved. Please upload a new valid government-issued ID document to complete verification.",s.textContent="Recently",o.style.display="flex"):(n.textContent="KYC Verification Required",t.textContent="Complete your KYC verification to unlock all account features. Upload a valid government-issued ID in the Security section.",s.textContent="Important",o.style.display="flex")}function ge(e){var l;const o=((l=L.currentUser)==null?void 0:l.uid)||null;if(o&&(e!=null&&e.__uid)&&e.__uid!==o)return;document.getElementById("Deposit-account").textContent=`${e.deposit||"$0.00"}`,document.getElementById("savings").textContent=`${e.savings||"$0.00"}`,document.getElementById("fixed").textContent=`${e.fixed||"$0.00"}`,te(e),ye(e),xe(e);const n=document.getElementById("user-first-name");e.firstName&&e.firstName.trim()!==""&&(n.textContent=e.firstName);const t=document.getElementById("cardholder-name"),s=document.getElementById("modal-cardholder-name");let a="";e.firstName&&e.lastName?a=`${e.firstName.toUpperCase()} ${e.lastName.toUpperCase()}`:e.firstName&&(a=e.firstName.toUpperCase()),a&&(t&&(t.textContent=a),s&&(s.textContent=a))}function ye(e){let o=!1,n=0;for(let a=1;a<=20;a++){const l=document.getElementById(`history${a}`);if(l){const d=e[`history${a}`]||"";if(d&&d.trim()!==""){if(ee(l,d),n<10){l.style.display="block";const r=l.querySelector(".mobile-transaction-item");r&&(r.style.display="flex"),n++}else{l.style.display="none";const r=l.querySelector(".mobile-transaction-item");r&&(r.style.display="none")}a>10&&(o=!0)}else{l.style.display="none";const r=l.querySelector(".mobile-transaction-item");r&&(r.style.display="none")}}}const t=document.getElementById("see-more");t&&(o?t.classList.remove("hidden"):t.classList.add("hidden"));const s=document.getElementById("recent-transactions");s&&(s.removeEventListener("click",$),s.addEventListener("click",$,{passive:!0}))}function xe(e){const o=document.getElementById("pending1"),n=document.getElementById("pending2"),t=document.getElementById("pending3"),s=document.getElementById("pending4"),a=document.getElementById("pending5"),l=document.getElementById("pending-list");function d(r,c){const p=c.split("|").map(S=>S.trim()),f=p[0]||"",y=p[1]||"",x=p[2]||"";p[3];const i=p[4]||"";p[5];const h=r.querySelector(".pending-description"),E=r.querySelector(".pending-recipient"),C=r.querySelector(".pending-type"),g=r.querySelector(".pending-amount"),b=r.querySelector(".pending-date"),m=r.querySelector(".pending-avatar"),u=r.querySelector(".pending-avatar-text");h&&(h.textContent=f),E&&(E.textContent=y),C&&(C.textContent=f),g&&(g.textContent=x),b&&(b.textContent=i),m&&u&&(u.textContent="PN",m.className="w-12 h-12 rounded-full flex items-center justify-center pending-avatar font-semibold text-sm bg-orange-50 text-orange-700")}e.pending1&&e.pending1.trim()!==""&&(o.classList.remove("hidden"),d(o,e.pending1),l&&l.appendChild(o)),e.pending2&&e.pending2.trim()!==""&&(n.classList.remove("hidden"),d(n,e.pending2),l&&l.appendChild(n)),e.pending3&&e.pending3.trim()!==""&&(t.classList.remove("hidden"),d(t,e.pending3),l&&l.appendChild(t)),e.pending4&&e.pending4.trim()!==""&&(s.classList.remove("hidden"),d(s,e.pending4),l&&l.appendChild(s)),e.pending5&&e.pending5.trim()!==""&&(a.classList.remove("hidden"),d(a,e.pending5),l&&l.appendChild(a)),e.pending1&&e.pending2&&e.pending3&&e.pending4&&e.pending5&&e.pending1.trim()!==""&&e.pending2.trim()!==""&&e.pending3.trim()!==""&&e.pending4.trim()!==""&&e.pending5.trim()!==""?document.getElementById("pending-limit-notice").classList.remove("hidden"):document.getElementById("pending-limit-notice").classList.add("hidden")}window.signOut=function(){Y(),Z(L).then(()=>{alert("Signed out successfully!"),window.location.href="login.html"}).catch(e=>{alert("Error signing out: "+e.message)})};let _=null;async function Ce(e){try{const o=T(B,"loans",e.uid);_&&_(),_=K(o,n=>{if(n.exists()){const t=n.data();console.log("Loan document updated:",t),console.log("Loan status:",t.status),be(t)}else console.log("Loan document does not exist"),D()},n=>{console.warn("Error listening to loan status:",n),n.code!=="permission-denied"&&D()})}catch(o){console.error("Error checking loan status:",o)}}function be(e){const o=e.status||e.loanStatus||"pending",n=String(o).toLowerCase().trim();e.loanAmount,e.submittedAt||e.createdAt,console.log("Updating loan status display:",{rawStatus:o,normalizedStatus:n,fullLoanData:e});const t=document.getElementById("loanStatusCard"),s=document.getElementById("loanProgressModal");s&&s.classList.add("hidden"),t?(t.classList.remove("hidden"),he(e,n)):console.error("Loan status card not found")}function he(e,o){const n=document.getElementById("loanStatusCard");if(!n)return;const t=e.loanAmount||0,s=e.submittedAt||e.createdAt;let a="N/A";s&&s.toDate&&(a=s.toDate().toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}));const l=n.querySelector("#loanCardAmount"),d=n.querySelector("#loanCardStatus"),r=n.querySelector("#loanCardDate"),c=n.querySelector("#loanCardIcon"),p=n.querySelector("#loanCardTitle"),f=n.querySelector("#loanCardMessage");l&&(l.textContent=`$${t.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`),r&&(r.textContent=a),o==="approved"?(c&&(c.className="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",c.innerHTML='<i class="fas fa-check-circle text-blue-600 text-2xl"></i>'),p&&(p.textContent="Loan Approved"),f&&(f.textContent="Your loan application has been approved. View details to see repayment schedule."),d&&(d.textContent="Approved",d.className="px-3 py-1 rounded-full text-xs font-semibold bg-blue-100 text-blue-700"),n.className="bg-white rounded-xl shadow-lg border-2 border-blue-200 p-5 mb-6"):o==="rejected"?(c&&(c.className="w-12 h-12 bg-red-100 rounded-full flex items-center justify-center",c.innerHTML='<i class="fas fa-times-circle text-red-600 text-2xl"></i>'),p&&(p.textContent="Loan Rejected"),f&&(f.textContent="Your loan application was not approved. Contact support for more information."),d&&(d.textContent="Rejected",d.className="px-3 py-1 rounded-full text-xs font-semibold bg-red-100 text-red-700"),n.className="bg-white rounded-xl shadow-lg border-2 border-red-200 p-5 mb-6"):(c&&(c.className="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",c.innerHTML='<i class="fas fa-spinner fa-spin text-blue-600 text-2xl"></i>'),p&&(p.textContent="Loan Under Review"),f&&(f.textContent="Your loan application is being reviewed. We will notify you once a decision is made."),d&&(d.textContent="Pending",d.className="px-3 py-1 rounded-full text-xs font-semibold bg-yellow-100 text-yellow-700"),n.className="bg-white rounded-xl shadow-lg border-2 border-blue-200 p-5 mb-6"),n.dataset.loanData=JSON.stringify(e),n.dataset.loanStatus=o}function X(e,o){const n=document.getElementById("loanProgressModal"),t=document.getElementById("loanProgressIcon"),s=document.getElementById("loanProgressTitle"),a=document.getElementById("loanProgressMessage"),l=document.getElementById("loanProgressAmount"),d=document.getElementById("loanProgressStatus"),r=document.getElementById("loanProgressDate"),c=document.getElementById("loanProgressBar");if(!n){console.error("Loan progress modal not found");return}const p=String(o).toLowerCase().trim();console.log("Showing loan status modal with status:",p,"original:",o);const f=e.loanAmount||0,y=e.submittedAt||e.createdAt;let x="N/A";if(y&&y.toDate&&(x=y.toDate().toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})),l.textContent=`$${f.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`,r.textContent=x,p==="approved"){console.log("Setting modal to APPROVED state"),t.className="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",t.innerHTML='<i class="fas fa-check-circle text-blue-600 text-3xl"></i>',s.textContent="Loan Application Approved!",a.textContent="Congratulations! Your loan application has been approved. Click the button below to view your loan details and repayment schedule.",d.textContent="Approved",d.className="text-sm font-semibold text-blue-600",c.style.width="100%",c.className="bg-blue-600 h-2 rounded-full transition-all duration-500";const i=n.querySelector("button");i&&(i.innerHTML='<i class="fas fa-arrow-right mr-2"></i>View Loan Details',i.onclick=function(){window.location.href="loan.html"},i.className="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-lg transition-all duration-200")}else if(p==="rejected"){console.log("Setting modal to REJECTED state"),t.className="w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",t.innerHTML='<i class="fas fa-times-circle text-red-600 text-3xl"></i>',s.textContent="Loan Application Rejected",a.textContent="We're sorry, but your loan application has been rejected. Please contact support for more information or try applying again later.",d.textContent="Rejected",d.className="text-sm font-semibold text-red-600",c.style.width="100%",c.className="bg-red-600 h-2 rounded-full transition-all duration-500";const i=n.querySelector("button");i&&(i.innerHTML='<i class="fas fa-times mr-2"></i>Close',i.onclick=function(){closeLoanProgressModal()},i.className="w-full text-white font-semibold py-3 px-6 rounded-lg transition-all duration-200",i.style.backgroundColor="#1800ac",i.onmouseover=function(){this.style.backgroundColor="#140099"},i.onmouseout=function(){this.style.backgroundColor="#1800ac"})}else{console.log("Setting modal to PENDING state"),t.className="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",t.innerHTML='<i class="fas fa-spinner fa-spin text-blue-600 text-3xl"></i>',s.textContent="Loan Application Under Review",a.textContent="Your loan application is being reviewed by our team. You will be notified once a decision has been made.",d.textContent="Pending",d.className="text-sm font-semibold text-yellow-600",c.style.width="50%",c.className="bg-blue-600 h-2 rounded-full transition-all duration-500";const i=n.querySelector("button");i&&(i.innerHTML='<i class="fas fa-times mr-2"></i>Close',i.onclick=function(){closeLoanProgressModal()},i.className="w-full text-white font-semibold py-3 px-6 rounded-lg transition-all duration-200",i.style.backgroundColor="#1800ac",i.onmouseover=function(){this.style.backgroundColor="#140099"},i.onmouseout=function(){this.style.backgroundColor="#1800ac"})}n.classList.remove("hidden")}function D(){const e=document.getElementById("loanStatusBadge"),o=document.getElementById("loanProgressModal"),n=document.getElementById("loanStatusCard");e&&e.classList.add("hidden"),o&&o.classList.add("hidden"),n&&n.classList.add("hidden")}window.openLoanProgressModal=function(){const e=document.getElementById("loanStatusCard");if(e&&e.dataset.loanData)try{const o=JSON.parse(e.dataset.loanData),n=e.dataset.loanStatus||o.status||"pending";X(o,n)}catch(o){console.error("Error parsing loan data:",o)}else{const o=L.currentUser;if(!o)return;const n=T(B,"loans",o.uid);R(n).then(t=>{if(t.exists()){const s=t.data();X(s,s.status||"pending")}}).catch(t=>{console.error("Error loading loan data:",t)})}};window.closeLoanProgressModal=function(){const e=document.getElementById("loanProgressModal");e&&e.classList.add("hidden")};
