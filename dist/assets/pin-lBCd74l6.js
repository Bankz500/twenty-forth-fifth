import"./modulepreload-polyfill-B5Qt9EMX.js";import{o as g,d as l,a as c,g as f,b as m,s as y,i as p,c as E}from"./firebase-client-BuhbagS3.js";import"./firebase-config-CwkpdvL9.js";g(m,async e=>{if(e){const a=l(c,"users",e.uid),t=await f(a);if(t.exists()){const n=t.data();document.getElementById("firstName").value=n.firstName||"",document.getElementById("firstName").placeholder=n.firstName||"First Name";const o=s=>{if(!s)return"0.00";const i=typeof s=="string"?parseFloat(s.replace(/[^0-9.-]/g,""))||0:Number(s)||0;return new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(i)};document.getElementById("profileUsername").textContent=n.firstName||"@syndicate",document.getElementById("Deposit-account").textContent=o(n.checking),document.getElementById("Profit-wallet").textContent=o(n.profit),document.getElementById("wallet").textContent=o(n.wallet),document.getElementById("welcome-message").textContent=`Welcome ${n.firstName}`,document.getElementById("displayEmail").textContent=e.email}else console.log("No user document found."),alert("No user data found.")}else console.log("No user signed in. Redirecting to sign-in page."),window.location.href="login.html"});window.signOut=function(){y(m).then(()=>{alert("Signed out successfully!"),window.location.href="login.html"}).catch(e=>{alert("Error signing out: "+e.message)})};const w=document.getElementById("changePinForm");w.addEventListener("submit",e=>{e.preventDefault();const a=document.getElementById("newPin").value;if(a.length!==5||isNaN(a)){alert("Please enter a valid 5-digit PIN.");return}const t=document.getElementById("submitButton");t.disabled=!0,t.textContent="Processing...",setTimeout(()=>{document.getElementById("passwordModal").classList.remove("hidden"),t.disabled=!1,t.textContent="Change PIN"},1e3)});const d=document.getElementById("passwordConfirmForm");d.addEventListener("submit",async e=>{e.preventDefault();const a=document.getElementById("email").value,t=document.getElementById("firebasePassword").value,n=document.getElementById("newPin").value,o=d.querySelector('button[type="submit"]');o.disabled=!0,o.textContent="Processing...";try{const i=(await p(m,a,t)).user;if(i){const u=l(c,"users",i.uid);await E(u,{pin:n},{merge:!0});const r=document.createElement("div");r.textContent="PIN Change updated!",r.className="text-blue-700 text-xs text-center mt-4",d.parentElement.appendChild(r),setTimeout(()=>{document.getElementById("passwordModal").classList.add("hidden")},2e3)}}catch(s){console.error("Error updating PIN:",s),alert("Error updating PIN: "+s.message)}finally{o.disabled=!1,o.textContent="Confirm"}});
